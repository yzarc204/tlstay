import{r as f,c as o,a as d,b as p,h as L,w as P,d as t,q as N,f as u,k as I,e as g,g as h,n as v,v as x,o as a,t as i,F as T,i as D,s as R,l as z}from"./app-osEW8NDv.js";import{u as J}from"./index-Cby59imu.js";import{_ as Z}from"./AdminLayout-aNMeXmBa.js";import{_ as H}from"./SelectSearchable-CZkmqHXk.js";import{r as Q}from"./ChevronLeftIcon-BR8-nT6c.js";import{r as _}from"./ExclamationCircleIcon-CSYZdRF6.js";import{r as X}from"./PhotoIcon-R2b1vxhe.js";import{a as Y}from"./FlashToaster-AYY5HN4c.js";/* empty css            */import"./MapPinIcon-BKuAuRil.js";import"./CalendarIcon-CPDdy-lK.js";import"./BuildingOfficeIcon-BGVcnTZ6.js";import"./ChevronUpDownIcon-C1VeXOTC.js";const ee={class:"space-y-6"},te={class:"flex items-center justify-between"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},se={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},le={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ne={class:"mt-6"},oe={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},de={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ue={class:"grid grid-cols-1 md:grid-cols-3 gap-6"},pe={class:"flex items-center gap-2"},me={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},ge={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ce={class:"flex items-center gap-2"},ve={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},fe={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ye={class:"flex items-center gap-2"},be={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},he={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},xe={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},_e=["value"],ke={class:"text-sm text-gray-700"},we={key:0,class:"mt-1 text-sm text-red-600"},Ve={class:"space-y-4"},Be={class:"space-y-4"},$e={class:"flex flex-col items-center"},Ce={key:0,class:"text-sm text-red-600"},Me={key:1,class:"space-y-4"},Pe={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Te={class:"relative"},Fe=["src","alt","onClick"],Ge=["onClick"],Ne={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},Ie={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},De={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Se={class:"text-sm text-red-600"},Ue={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},Ee={class:"text-sm text-green-600"},je={class:"flex justify-end gap-3 pt-4 border-t"},We=["disabled"],et={__name:"Create",props:{streets:Array,errors:Object},setup(S){const U={Wifi:"Wifi",AirConditioning:"Điều hòa",HotWater:"Nóng lạnh",PrivateKitchen:"Bếp riêng",SharedKitchen:"Bếp chung",SharedBathroom:"Vệ sinh chung",PrivateBathroom:"Vệ sinh khép kín",Bed:"Giường",Wardrobe:"Tủ",Refrigerator:"Tủ lạnh",Balcony:"Ban công",SharedWashingMachine:"Máy giặt chung",PrivateWashingMachine:"Máy giặt riêng",SharedDryer:"Máy sấy quần áo chung",PrivateDryer:"Máy sấy quần áo riêng"},r=f({name:"",street_detail:"",street_id:"",description:"",amenities:[],price_per_day:"",price_per_week:"",price_per_month:"",latitude:"",longitude:""}),B=f(null),F=f(null),k=f([]),w=f([]),c=f([]),$=f(!1),y=f(""),C=f(""),n=f({}),E=s=>s?new Intl.NumberFormat("vi-VN").format(s):"0",M=s=>!s||s===0?"":E(s)+" đ",{isOverDropZone:j}=J(F,{onDrop:s=>{s&&s.length>0&&G(Array.from(s))}}),G=s=>{if(y.value="",w.value.length+s.length>10){y.value="Tối đa 10 ảnh";return}s.forEach(e=>{if(e.size>5*1024*1024){y.value=`Ảnh ${e.name} vượt quá 5MB`;return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/webp"].includes(e.type)){y.value=`File ${e.name} không phải là ảnh hợp lệ (JPEG, PNG, JPG, GIF, WEBP)`;return}w.value.push(e);const m=new FileReader;m.onload=V=>{k.value.push(V.target.result)},m.readAsDataURL(e)})},W=s=>{const e=Array.from(s.target.files);G(e),B.value&&(B.value.value="")},q=s=>{w.value.splice(s,1),k.value.splice(s,1);const e=c.value.indexOf(s);e>-1&&c.value.splice(e,1),c.value=c.value.map(l=>l>s?l-1:l)},O=s=>{const e=c.value.indexOf(s);e>-1?c.value.splice(e,1):c.value.push(s)},b=s=>{n.value[s]&&delete n.value[s]},A=()=>{const s={};return r.value.name?.trim()||(s.name="Vui lòng nhập tên nhà trọ"),r.value.street_detail?.trim()||(s.street_detail="Vui lòng nhập địa chỉ cụ thể"),r.value.street_id||(s.street_id="Vui lòng chọn đường"),(!r.value.price_per_day||r.value.price_per_day<=0)&&(s.price_per_day="Vui lòng nhập giá thuê hợp lệ"),r.value.latitude&&(r.value.latitude<-90||r.value.latitude>90)&&(s.latitude="Vĩ độ phải trong khoảng -90 đến 90"),r.value.longitude&&(r.value.longitude<-180||r.value.longitude>180)&&(s.longitude="Kinh độ phải trong khoảng -180 đến 180"),n.value=s,Object.keys(s).length===0},K=()=>{if(y.value="",C.value="",!A()){y.value="Vui lòng kiểm tra lại các trường bắt buộc";return}$.value=!0;const s=new FormData;s.append("name",r.value.name),s.append("street_detail",r.value.street_detail),s.append("street_id",r.value.street_id),r.value.description&&s.append("description",r.value.description),s.append("price_per_day",r.value.price_per_day),r.value.price_per_week&&s.append("price_per_week",r.value.price_per_week),r.value.price_per_month&&s.append("price_per_month",r.value.price_per_month),r.value.latitude&&s.append("latitude",r.value.latitude),r.value.longitude&&s.append("longitude",r.value.longitude),r.value.amenities.forEach(e=>{s.append("amenities[]",e)}),w.value.forEach(e=>{s.append("images[]",e)}),c.value.forEach(e=>{s.append("featured_image_indices[]",e)}),z.post("/admin/houses",s,{preserveScroll:!0,onSuccess:()=>{C.value="Đã thêm nhà trọ thành công!",r.value={name:"",street_detail:"",street_id:"",description:"",amenities:[],price_per_day:"",price_per_week:"",price_per_month:"",latitude:"",longitude:""},w.value=[],k.value=[],c.value=[]},onError:e=>{n.value=e,e.message&&(y.value=e.message)},onFinish:()=>{$.value=!1}})};return(s,e)=>(a(),o(T,null,[d(p(L),{title:"Thêm nhà trọ mới"}),d(Z,{title:"Thêm nhà trọ mới"},{default:P(()=>[t("div",ee,[t("div",te,[t("div",null,[d(p(N),{href:"/admin/houses",class:"text-primary hover:text-primary-600 mb-2 inline-flex items-center text-sm"},{default:P(()=>[d(p(Q),{class:"h-4 w-4 mr-1"}),e[20]||(e[20]=u(" Quay lại danh sách ",-1))]),_:1}),e[21]||(e[21]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Thêm nhà trọ mới",-1))])]),t("form",{onSubmit:I(K,["prevent"]),class:"bg-white rounded-lg shadow-sm p-6 space-y-6"},[t("div",null,[e[26]||(e[26]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Thông tin cơ bản",-1)),t("div",re,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Tên nhà trọ "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>r.value.name=l),type:"text",required:"",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.name?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Nhập tên nhà trọ",onBlur:e[1]||(e[1]=l=>b("name"))},null,34),[[x,r.value.name]]),n.value.name?(a(),o("p",se,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.name),1)])):g("",!0)]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Địa chỉ cụ thể "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>r.value.street_detail=l),type:"text",required:"",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.street_detail?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Số nhà, ngõ ngách...",onBlur:e[3]||(e[3]=l=>b("street_detail"))},null,34),[[x,r.value.street_detail]]),n.value.street_detail?(a(),o("p",le,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.street_detail),1)])):g("",!0)]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Đường "),t("span",{class:"text-red-500"},"*")],-1)),d(H,{modelValue:r.value.street_id,"onUpdate:modelValue":[e[4]||(e[4]=l=>r.value.street_id=l),e[5]||(e[5]=l=>b("street_id"))],options:S.streets,"option-value":"id","option-label":l=>l.parent?`${l.name} (${l.parent.name})`:l.name,"filter-by":l=>l.parent?`${l.name} ${l.parent.name}`:l.name,placeholder:"Tìm kiếm và chọn đường...",error:n.value.street_id},null,8,["modelValue","options","option-label","filter-by","error"])])]),t("div",ne,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mô tả",-1)),h(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>r.value.description=l),rows:"4",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.description?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Nhập mô tả về nhà trọ...",onBlur:e[7]||(e[7]=l=>b("description"))},null,34),[[x,r.value.description]]),n.value.description?(a(),o("p",oe,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.description),1)])):g("",!0)])]),t("div",null,[e[29]||(e[29]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Vị trí",-1)),t("div",ae,[t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Vĩ độ",-1)),h(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>r.value.latitude=l),type:"number",step:"any",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.latitude?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"21.0285",onBlur:e[9]||(e[9]=l=>b("latitude"))},null,34),[[x,r.value.latitude]]),n.value.latitude?(a(),o("p",ie,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.latitude),1)])):g("",!0)]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Kinh độ",-1)),h(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>r.value.longitude=l),type:"number",step:"any",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.longitude?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"105.8542",onBlur:e[11]||(e[11]=l=>b("longitude"))},null,34),[[x,r.value.longitude]]),n.value.longitude?(a(),o("p",de,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.longitude),1)])):g("",!0)])])]),t("div",null,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Giá và thông tin",-1)),t("div",ue,[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[u(" Giá thuê/ngày (VNĐ) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",pe,[h(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>r.value.price_per_day=l),type:"number",step:"1000",min:"0",required:"",class:v(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.price_per_day?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"500000",onBlur:e[13]||(e[13]=l=>b("price_per_day"))},null,34),[[x,r.value.price_per_day,void 0,{number:!0}]]),t("span",me,i(M(r.value.price_per_day)),1)]),n.value.price_per_day?(a(),o("p",ge,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.price_per_day),1)])):g("",!0)]),t("div",null,[e[31]||(e[31]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giá thuê/tuần (VNĐ) ",-1)),t("div",ce,[h(t("input",{"onUpdate:modelValue":e[14]||(e[14]=l=>r.value.price_per_week=l),type:"number",step:"1000",min:"0",class:v(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.price_per_week?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"3000000",onBlur:e[15]||(e[15]=l=>b("price_per_week"))},null,34),[[x,r.value.price_per_week,void 0,{number:!0}]]),t("span",ve,i(M(r.value.price_per_week)),1)]),n.value.price_per_week?(a(),o("p",fe,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.price_per_week),1)])):g("",!0),e[32]||(e[32]=t("p",{class:"mt-1 text-xs text-gray-500"},"Để trống nếu tính theo giá ngày × 7",-1))]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giá thuê/tháng (VNĐ) ",-1)),t("div",ye,[h(t("input",{"onUpdate:modelValue":e[16]||(e[16]=l=>r.value.price_per_month=l),type:"number",step:"1000",min:"0",class:v(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.price_per_month?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"12000000",onBlur:e[17]||(e[17]=l=>b("price_per_month"))},null,34),[[x,r.value.price_per_month,void 0,{number:!0}]]),t("span",be,i(M(r.value.price_per_month)),1)]),n.value.price_per_month?(a(),o("p",he,[d(p(_),{class:"h-4 w-4"}),u(" "+i(n.value.price_per_month),1)])):g("",!0),e[34]||(e[34]=t("p",{class:"mt-1 text-xs text-gray-500"},"Để trống nếu tính theo giá ngày × 30",-1))])])]),t("div",null,[e[36]||(e[36]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Tiện nghi",-1)),t("div",xe,[(a(),o(T,null,D(U,(l,m)=>t("label",{key:m,class:"flex items-center space-x-2 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50"},[h(t("input",{"onUpdate:modelValue":e[18]||(e[18]=V=>r.value.amenities=V),type:"checkbox",value:m,class:"rounded border-gray-300 text-primary focus:ring-primary"},null,8,_e),[[R,r.value.amenities]]),t("span",ke,i(l),1)])),64))]),n.value.amenities?(a(),o("p",we,i(n.value.amenities),1)):g("",!0)]),t("div",null,[e[43]||(e[43]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Hình ảnh",-1)),t("div",Ve,[t("div",{ref_key:"dropZoneRef",ref:F,class:v(["border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",p(j)?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400"]),onClick:e[19]||(e[19]=l=>B.value?.click())},[t("input",{ref_key:"fileInput",ref:B,type:"file",multiple:"",accept:"image/*",onChange:W,class:"hidden"},null,544),t("div",Be,[t("div",$e,[d(p(X),{class:"h-12 w-12 text-gray-400 mb-2"}),e[37]||(e[37]=t("p",{class:"text-sm font-medium text-gray-700"},[u(" Kéo thả ảnh vào đây hoặc "),t("span",{class:"text-primary hover:text-primary-600 font-medium underline"}," chọn từ máy tính ")],-1)),e[38]||(e[38]=t("p",{class:"mt-1 text-xs text-gray-500"}," Tối đa 10 ảnh, mỗi ảnh tối đa 5MB ",-1)),e[39]||(e[39]=t("p",{class:"mt-1 text-xs text-gray-500"}," Định dạng: JPEG, PNG, JPG, GIF, WEBP ",-1))])])],2),n.value.images?(a(),o("p",Ce,i(n.value.images),1)):g("",!0),k.value.length>0?(a(),o("div",Me,[e[42]||(e[42]=t("p",{class:"text-sm text-gray-600"},[t("span",{class:"font-medium"},"Lưu ý:"),u(" Chọn các ảnh sẽ hiển thị trong trang chi tiết nhà trọ ")],-1)),t("div",Pe,[(a(!0),o(T,null,D(k.value,(l,m)=>(a(),o("div",{key:m,class:"relative group"},[t("div",Te,[t("img",{src:l,alt:`Preview ${m+1}`,class:v(["w-full h-32 object-cover rounded-lg border-2 transition-all cursor-pointer",c.value.includes(m)?"border-primary ring-2 ring-primary ring-offset-2":"border-gray-200 hover:border-gray-300"]),onClick:V=>O(m)},null,10,Fe),t("button",{type:"button",onClick:I(V=>q(m),["stop"]),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10"},[d(p(Y),{class:"h-4 w-4"})],8,Ge),t("div",{class:v(["absolute top-2 left-2 rounded-full p-1 shadow-lg transition-all duration-200",c.value.includes(m)?"bg-primary text-white ring-2 ring-primary ring-offset-2":"bg-white text-gray-400 hover:bg-gray-50"])},[c.value.includes(m)?(a(),o("svg",Ne,[...e[40]||(e[40]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):(a(),o("svg",Ie,[...e[41]||(e[41]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])]))],2)])]))),128))])])):g("",!0)])]),y.value?(a(),o("div",De,[t("p",Se,i(y.value),1)])):g("",!0),C.value?(a(),o("div",Ue,[t("p",Ee,i(C.value),1)])):g("",!0),t("div",je,[d(p(N),{href:"/admin/houses",class:"px-6 py-2 border-2 border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"},{default:P(()=>[...e[44]||(e[44]=[u(" Hủy ",-1)])]),_:1}),t("button",{type:"submit",disabled:$.value,class:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},i($.value?"Đang lưu...":"Thêm nhà trọ"),9,We)])],32)])]),_:1})],64))}};export{et as default};
