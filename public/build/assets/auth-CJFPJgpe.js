import{a6 as a,l as n}from"./app-BdvrGfPi.js";const l=a("auth",{state:()=>({user:null}),getters:{isAuthenticated(r){return!!r.user},currentUser(r){return r.user}},actions:{syncUser(){if(typeof window<"u"&&window.Inertia){const r=window.Inertia.page;r?.props?.auth?.user&&(this.user=r.props.auth.user)}},login(r,o,t){n.post("/login",r,{preserveScroll:!0,onSuccess:s=>{s.props?.auth?.user&&(this.user=s.props.auth.user),o&&o(s)},onError:s=>{const e=Object.values(s)[0],i=Array.isArray(e)?e[0]:e;t&&t(i||"Email hoặc mật khẩu không đúng")}})},syncUserFromPage(){if(typeof window<"u"&&window.Inertia)try{const r=window.Inertia.page;r?.props?.auth?.user?this.user=r.props.auth.user:this.user=null}catch{}},register(r,o,t){const s={name:r.name.trim(),email:r.email.toLowerCase().trim(),phone:r.phone?.replace(/\s+/g,"")||"",password:r.password,password_confirmation:r.confirmPassword||r.password};n.post("/register",s,{preserveScroll:!0,onSuccess:e=>{e.props?.auth?.user&&(this.user=e.props.auth.user),o&&o(e)},onError:e=>{const i=Object.values(e)[0],u=Array.isArray(i)?i[0]:i;t&&t(u||"Đã có lỗi xảy ra khi đăng ký")}})},logout(r){n.post("/logout",{},{preserveScroll:!1,onSuccess:()=>{this.user=null,r&&r()}})}}});export{l as u};
