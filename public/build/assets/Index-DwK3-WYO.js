import{p as f,H as V,c as d,a as g,b as a,h as F,w as N,d as t,e as p,o as m,t as u,f as _,n as B,k as G,g as x,s as R,v as T,F as U,l as v}from"./app-CH4CEp7f.js";import{_ as H}from"./AdminLayout-BT6D36Nk.js";import{r as D}from"./FlashToaster-Co9bFWRi.js";/* empty css            */import"./MapPinIcon-A7TLZLbH.js";import"./CalendarIcon-DL8s8YjY.js";import"./PhotoIcon-CGQz7Bxq.js";import"./BuildingOfficeIcon-BvyATTDh.js";const j={class:"space-y-6"},q={key:0,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},A={class:"text-green-800 whitespace-pre-line"},P={key:1,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Q={class:"text-red-800 whitespace-pre-line"},z={class:"bg-white rounded-lg shadow-sm p-6 space-y-6"},E={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},O={class:"bg-gray-50 rounded-lg p-4 mb-6"},J={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},K={class:"font-mono text-lg font-semibold text-gray-900"},L={key:0,class:"inline-block mt-1 px-2 py-1 text-xs bg-purple-100 text-purple-800 rounded"},W={key:1,class:"inline-block mt-1 px-2 py-1 text-xs bg-green-100 text-green-800 rounded"},X={class:"flex items-center space-x-4 mb-4"},Z={class:"flex items-center space-x-2 cursor-pointer"},ee={key:0,class:"grid grid-cols-1 md:grid-cols-2 gap-4"},te={class:"flex items-center space-x-3"},se=["disabled"],ne=["disabled"],ae={class:"bg-white rounded-lg shadow-sm p-6 space-y-6"},oe={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},le=["disabled"],ye={__name:"Index",props:{systemTimeInfo:{type:Object,default:()=>({is_manual:!1,current_datetime:null,real_datetime:null,manual_date:null,manual_time:null})}},setup(c){const r=c,Y=()=>(r.systemTimeInfo?.manual_time||"00:00:00").substring(0,5),y=s=>{if(!s){const e=new Date,o=String(e.getDate()).padStart(2,"0"),l=String(e.getMonth()+1).padStart(2,"0"),i=e.getFullYear();return`${o}/${l}/${i}`}if(s.match(/^\d{4}-\d{2}-\d{2}$/)){const[e,o,l]=s.split("-");return`${l}/${o}/${e}`}return s.match(/^\d{2}\/\d{2}\/\d{4}$/),s},k=()=>r.systemTimeInfo?.manual_date_formatted?r.systemTimeInfo.manual_date_formatted:r.systemTimeInfo?.manual_date?y(r.systemTimeInfo.manual_date):y(null),M=s=>{let e=s.target.value.replace(/\D/g,"");e.length>2&&e.length<=4?e=e.substring(0,2)+"/"+e.substring(2):e.length>4&&(e=e.substring(0,2)+"/"+e.substring(2,4)+"/"+e.substring(4,8)),n.date=e},n=f({enabled:r.systemTimeInfo?.is_manual||!1,date:k(),time:Y()}),h=f({}),b=f({}),$=s=>{if(!s)return null;if(s.match(/^\d{4}-\d{2}-\d{2}$/))return s;const e=s.match(/^(\d{2})\/(\d{2})\/(\d{4})$/);if(e){const[,o,l,i]=e;return`${i}-${l}-${o}`}return s},w=()=>{if(n.enabled&&n.date){if(!/^\d{2}\/\d{2}\/\d{4}$/.test(n.date)){alert("Vui lòng nhập ngày theo định dạng DD/MM/YYYY (ví dụ: 01/03/2025)");return}const[e,o,l]=n.date.split("/"),i=new Date(l,o-1,e);if(i.getDate()!=e||i.getMonth()!=o-1||i.getFullYear()!=l){alert("Ngày không hợp lệ. Vui lòng kiểm tra lại.");return}const S={...n.data(),date:$(n.date)};n.transform(()=>S).post("/admin/god-system/system-time",{preserveScroll:!0,onSuccess:()=>{v.reload({only:["systemTimeInfo"]})}})}else n.post("/admin/god-system/system-time",{preserveScroll:!0,onSuccess:()=>{v.reload({only:["systemTimeInfo"]})}})},C=()=>{confirm("Bạn có chắc chắn muốn reset về thời gian thực?")&&h.post("/admin/god-system/system-time/reset",{preserveScroll:!0,onSuccess:()=>{v.reload({only:["systemTimeInfo"]}),n.enabled=!1}})},I=()=>{confirm("Bạn có chắc chắn muốn chạy cập nhật trạng thái phòng ngay bây giờ?")&&b.post("/admin/god-system/trigger-update-room",{preserveScroll:!0,onSuccess:()=>{}})};return V(()=>r.systemTimeInfo,s=>{s&&(n.enabled=s.is_manual||!1,s.is_manual&&(s.manual_date_formatted?n.date=s.manual_date_formatted:s.manual_date&&(n.date=y(s.manual_date))),s.manual_time&&(n.time=s.manual_time.substring(0,5)))},{deep:!0,immediate:!0}),(s,e)=>(m(),d(U,null,[g(a(F),{title:"God System"}),g(H,{title:"God System"},{default:N(()=>[t("div",j,[e[13]||(e[13]=t("div",{class:"flex items-center justify-between"},[t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"God System"),t("p",{class:"text-gray-600 mt-1"},"Quản lý thời gian hệ thống và cập nhật trạng thái phòng")])],-1)),s.$page.props.flash?.success?(m(),d("div",q,[t("p",A,u(s.$page.props.flash.success),1)])):p("",!0),s.$page.props.flash?.error?(m(),d("div",P,[t("p",Q,u(s.$page.props.flash.error),1)])):p("",!0),t("div",z,[t("div",null,[t("h2",E,[g(a(D),{class:"w-5 h-5 mr-2 text-purple-600"}),e[3]||(e[3]=_(" Quản lý thời gian hệ thống ",-1))]),e[10]||(e[10]=t("p",{class:"text-sm text-gray-600 mb-6"}," Cho phép thay đổi ngày và giờ của website thủ công để test hoặc điều chỉnh hệ thống. Thời gian này sẽ được sử dụng bởi tất cả các chức năng liên quan đến ngày tháng. ",-1)),t("div",O,[t("div",J,[t("div",null,[e[4]||(e[4]=t("p",{class:"text-sm text-gray-600 mb-1"},"Thời gian thực:",-1)),t("p",K,u(c.systemTimeInfo?.real_datetime||"N/A"),1)]),t("div",null,[e[5]||(e[5]=t("p",{class:"text-sm text-gray-600 mb-1"},"Thời gian hệ thống đang sử dụng:",-1)),t("p",{class:B(["font-mono text-lg font-semibold",c.systemTimeInfo?.is_manual?"text-purple-600":"text-gray-900"])},u(c.systemTimeInfo?.current_datetime||"N/A"),3),c.systemTimeInfo?.is_manual?(m(),d("span",L," Manual Mode ")):(m(),d("span",W," Real Time "))])])]),t("form",{onSubmit:G(w,["prevent"]),class:"space-y-4"},[t("div",X,[t("label",Z,[x(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>a(n).enabled=o),type:"checkbox",class:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"},null,512),[[R,a(n).enabled]]),e[6]||(e[6]=t("span",{class:"text-sm font-medium text-gray-700"},"Bật chế độ thời gian thủ công",-1))])]),a(n).enabled?(m(),d("div",ee,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Ngày (DD/MM/YYYY) ",-1)),x(t("input",{"onUpdate:modelValue":e[1]||(e[1]=o=>a(n).date=o),type:"text",placeholder:"dd/mm/yyyy",pattern:"\\d{2}/\\d{2}/\\d{4}",maxlength:"10",required:"",onInput:M,class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500"},null,544),[[T,a(n).date]]),e[8]||(e[8]=t("p",{class:"text-xs text-gray-500 mt-1"},"Ví dụ: 01/03/2025",-1))]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giờ (HH:MM) ",-1)),x(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>a(n).time=o),type:"time",class:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-purple-500 focus:border-purple-500"},null,512),[[T,a(n).time]])])])):p("",!0),t("div",te,[t("button",{type:"submit",disabled:a(n).processing,class:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},u(a(n).processing?"Đang xử lý...":"Cập nhật thời gian"),9,se),c.systemTimeInfo?.is_manual?(m(),d("button",{key:0,type:"button",onClick:C,disabled:a(h).processing,class:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},u(a(h).processing?"Đang xử lý...":"Reset về thời gian thực"),9,ne)):p("",!0)])],32)])]),t("div",ae,[t("div",null,[t("h2",oe,[g(a(D),{class:"w-5 h-5 mr-2 text-blue-600"}),e[11]||(e[11]=_(" Cập nhật trạng thái phòng ",-1))]),e[12]||(e[12]=t("p",{class:"text-sm text-gray-600 mb-4"}," Chạy thủ công command cập nhật trạng thái phòng (loại bỏ người hết hạn, chuyển người vào ngày check-in). Command này sẽ sử dụng thời gian hệ thống hiện tại (real hoặc manual). ",-1)),t("button",{onClick:I,disabled:a(b).processing,class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},u(a(b).processing?"Đang xử lý...":"Chạy cập nhật trạng thái phòng"),9,le)])])])]),_:1})],64))}};export{ye as default};
