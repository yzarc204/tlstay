import{r as T,H,A as G,c,d as e,a as b,w as D,f as $,b as j,t as g,F as B,i as q,g as N,n as C,e as S,k as R,M as z,o as i,N as Z,y as K,T as X,O as Y,P as ee,z as te,v as O,l as P,h as re,q as se,j as ne,s as ae}from"./app-CMA34vXU.js";import{c as oe,_ as le}from"./AdminLayout-_qJaSIGJ.js";import{_ as L}from"./Button-DOvRP2_e.js";import{r as W}from"./PlusIcon-XSXq2t3R.js";import{r as ie}from"./ChevronDownIcon-DdUN0aNz.js";import{r as de}from"./TrashIcon-B5F-sivz.js";import{u as Q,a as ue}from"./FlashToaster-kFl7lRTI.js";import{u as me}from"./useConfirm-DLlH93xz.js";import{_ as J}from"./SelectSearchable-BatLVrUK.js";import{_ as E}from"./DatePicker-Cr2wSAl8.js";import{a as ce}from"./amenityIcons-BALqztEq.js";import{r as ge}from"./ChevronLeftIcon-Cw5M-WRN.js";/* empty css            */import"./MapPinIcon-R0714Wun.js";import"./CalendarIcon-DVq0ppdg.js";import"./PhotoIcon-DIUb7Ynx.js";import"./BuildingOfficeIcon-DWu6c7zk.js";import"./ChevronUpDownIcon-Brv7XhVr.js";import"./ChevronRightIcon-v0Pvl7dS.js";const pe={class:"space-y-4"},ye={class:"flex items-center justify-between"},he={class:"flex items-center gap-3"},fe={class:"text-sm text-gray-600"},ve={class:"space-y-4"},be=["onClick"],xe={class:"flex items-center gap-3"},_e={class:"text-lg font-semibold text-gray-900"},$e={class:"text-sm text-gray-600"},ke={class:"flex items-center gap-2"},we=["onClick"],Ve={class:"p-6"},Ce={class:"grid grid-cols-4 md:grid-cols-6 lg:grid-cols-8 gap-3"},Te=["onClick"],Se={class:"text-center"},Ae={class:"text-sm font-semibold text-gray-900 mb-1"},Ne={class:"text-xs text-gray-600"},Fe=["onClick"],je={__name:"RoomDiagram",props:{roomsByFloor:{type:Object,required:!0},house:{type:Object,required:!0}},emits:["select-room","add-room","add-floor","delete-floor"],setup(n,{expose:F,emit:a}){const k=n,w=a,p=T(null),d=T(!1),s=T(null),u=T([]);H(()=>k.house.floors,y=>{y&&u.value.length===0&&(u.value=Array.from({length:y},(v,_)=>_+1))},{immediate:!0});const l=G(()=>{const y=[];for(let v=1;v<=k.house.floors;v++)y.push(v);return y.sort((v,_)=>_-v)}),f=G(()=>{let y=0;return Object.values(k.roomsByFloor).forEach(v=>{const _=Array.isArray(v)?v:Object.values(v);y+=_.length}),y}),V=y=>{const v=String(y),_=k.roomsByFloor[v];return _?Array.isArray(_)?_:Object.values(_):[]},A=y=>{const v=u.value.indexOf(y);v>-1?u.value.splice(v,1):u.value.push(y)},M=y=>V(y).length===0&&k.house.floors>1,U=y=>{p.value=y,w("select-room",y)},o=y=>{s.value=y,w("add-room",y)},x=()=>{const y=u.value.length>0?Math.max(...u.value):1;w("add-room",y)},h=y=>y?new Intl.NumberFormat("vi-VN").format(y):"0",t=y=>({available:"Trống",active:"Đang ở"})[y]||"Trống",r=y=>{const v={available:"bg-green-100 text-green-800",active:"bg-red-100 text-red-800"};return v[y]||v.available},m=y=>y==="active"?"border-red-300 bg-red-50 hover:border-red-400":"border-gray-200 bg-gray-50 hover:border-gray-300 hover:shadow-sm";return F({newRoomFloor:s,showAddRoomModal:d}),(y,v)=>(i(),c("div",pe,[e("div",ye,[e("div",he,[b(L,{onClick:v[0]||(v[0]=_=>y.$emit("add-floor")),size:"sm",variant:"outline"},{default:D(()=>[b(j(W),{class:"h-4 w-4 mr-1"}),v[2]||(v[2]=$(" Thêm tầng ",-1))]),_:1}),b(L,{onClick:v[1]||(v[1]=_=>x()),size:"sm"},{default:D(()=>[b(j(W),{class:"h-4 w-4 mr-1"}),v[3]||(v[3]=$(" Thêm phòng ",-1))]),_:1})]),e("div",fe," Tổng: "+g(n.house.floors)+" tầng, "+g(f.value)+" phòng ",1)]),e("div",ve,[(i(!0),c(B,null,q(l.value,_=>(i(),c("div",{key:_,class:"bg-white rounded-lg border border-gray-200 overflow-hidden"},[e("div",{class:"flex items-center justify-between p-4 bg-gray-50 border-b border-gray-200 cursor-pointer hover:bg-gray-100 transition-colors",onClick:I=>A(_)},[e("div",xe,[b(j(ie),{class:C(["h-5 w-5 text-gray-500 transition-transform",u.value.includes(_)?"rotate-0":"-rotate-90"])},null,8,["class"]),e("h3",_e," Tầng "+g(_),1),e("span",$e," ("+g(V(_).length)+" phòng) ",1)]),e("div",ke,[M(_)?(i(),c("button",{key:0,onClick:R(I=>y.$emit("delete-floor",_),["stop"]),class:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Xóa tầng"},[b(j(de),{class:"h-5 w-5"})],8,we)):S("",!0)])],8,be),N(e("div",Ve,[e("div",Ce,[(i(!0),c(B,null,q(V(_),I=>(i(),c("div",{key:I.id,onClick:Cr=>U(I),class:C(["relative p-4 border-2 rounded-lg cursor-pointer transition-all",p.value?.id===I.id?"border-primary bg-primary/10 shadow-md":m(I.status)])},[e("div",Se,[e("div",Ae,g(I.room_number),1),e("div",Ne,g(h(I.price_per_day))+"đ/ngày ",1),e("div",{class:C(["mt-2 text-xs px-2 py-1 rounded-full inline-block",r(I.status)])},g(t(I.status)),3)])],10,Te))),128)),e("div",{onClick:I=>o(_),class:"p-4 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-primary hover:bg-primary/5 transition-all flex items-center justify-center"},[b(j(W),{class:"h-8 w-8 text-gray-400"})],8,Fe)])],512),[[z,u.value.includes(_)]])]))),128))])]))}},Ie={__name:"SidePanel",props:{isOpen:{type:Boolean,default:!1}},emits:["close"],setup(n){const F=Z();return(a,k)=>(i(),c(B,null,[(i(),K(Y,{to:"body"},[b(X,{"enter-active-class":"transition-opacity duration-300","enter-from-class":"opacity-0","enter-to-class":"opacity-100","leave-active-class":"transition-opacity duration-300","leave-from-class":"opacity-100","leave-to-class":"opacity-0"},{default:D(()=>[n.isOpen?(i(),c("div",{key:0,onClick:k[0]||(k[0]=w=>a.$emit("close")),class:"fixed inset-0 z-40 bg-black/50",style:{top:"0",left:"0",right:"0",bottom:"0",width:"100%",height:"100%","min-height":"100vh"}})):S("",!0)]),_:1})])),(i(),K(Y,{to:"body"},[b(X,{"enter-active-class":"transition-transform duration-300 ease-out","enter-from-class":"translate-x-full","enter-to-class":"translate-x-0","leave-active-class":"transition-transform duration-300 ease-in","leave-from-class":"translate-x-0","leave-to-class":"translate-x-full"},{default:D(()=>[n.isOpen?(i(),c("aside",{key:0,class:C(j(oe)("fixed right-0 top-0 z-50 h-screen w-full md:w-1/2 bg-white shadow-xl overflow-y-auto",j(F).class))},[ee(a.$slots,"default")],2)):S("",!0)]),_:3})]))],64))}},De={class:"space-y-4"},Me=["value"],Oe={key:0,class:"mt-1 text-sm text-red-600"},Be=["value","max"],Ue={key:0,class:"mt-1 text-sm text-red-600"},Pe={class:"flex items-center gap-2"},qe=["value"],Ee={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},He={key:0,class:"mt-1 text-sm text-red-600"},Re={class:"flex items-center gap-2"},Le=["value"],ze={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},Ge={key:0,class:"mt-1 text-sm text-red-600"},We={class:"flex items-center gap-2"},Ke=["value"],Xe={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},Ye={key:0,class:"mt-1 text-sm text-red-600"},Qe=["value"],Je={key:0,class:"mt-1 text-sm text-red-600"},Ze=["value"],et={key:0,class:"mt-1 text-sm text-red-600"},tt={class:"grid grid-cols-2 gap-2 max-h-64 overflow-y-auto border border-gray-200 rounded-lg p-3"},rt=["checked","onChange"],st={class:"text-sm text-gray-700"},nt={class:"mt-2 text-xs text-gray-500"},at={key:0,class:"text-blue-600"},ot={key:1},lt={__name:"RoomInfoTab",props:{modelValue:{type:Object,required:!0},house:{type:Object,required:!0},errors:{type:Object,default:()=>({})},hasInheritedAmenities:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:F}){const a=u=>u?new Intl.NumberFormat("vi-VN").format(u):"0",k=u=>!u||u===0?"":a(u)+" đ",w=n,p=F,d={Wifi:"Wifi",AirConditioning:"Điều hòa",HotWater:"Nóng lạnh",PrivateKitchen:"Bếp riêng",SharedKitchen:"Bếp chung",SharedBathroom:"Vệ sinh chung",PrivateBathroom:"Vệ sinh khép kín",Bed:"Giường",Wardrobe:"Tủ",Refrigerator:"Tủ lạnh",Balcony:"Ban công",SharedWashingMachine:"Máy giặt chung",PrivateWashingMachine:"Máy giặt riêng",SharedDryer:"Máy sấy quần áo chung",PrivateDryer:"Máy sấy quần áo riêng"},s=(u,l)=>{const f=[...w.modelValue.amenities];if(l)f.includes(u)||f.push(u);else{const V=f.indexOf(u);V>-1&&f.splice(V,1)}p("update:modelValue",{...w.modelValue,amenities:f})};return(u,l)=>(i(),c("div",De,[e("div",null,[l[7]||(l[7]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Số phòng "),e("span",{class:"text-red-500"},"*")],-1)),e("input",{value:n.modelValue.room_number,onInput:l[0]||(l[0]=f=>u.$emit("update:modelValue",{...n.modelValue,room_number:f.target.value})),type:"text",required:"",class:C(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.room_number?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"])},null,42,Me),n.errors.room_number?(i(),c("p",Oe,g(n.errors.room_number),1)):S("",!0)]),e("div",null,[l[8]||(l[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Tầng "),e("span",{class:"text-red-500"},"*")],-1)),e("input",{value:n.modelValue.floor,onInput:l[1]||(l[1]=f=>u.$emit("update:modelValue",{...n.modelValue,floor:Number(f.target.value)})),type:"number",min:"1",max:n.house.floors,required:"",class:C(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.floor?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"])},null,42,Be),n.errors.floor?(i(),c("p",Ue,g(n.errors.floor),1)):S("",!0)]),e("div",null,[l[9]||(l[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Giá thuê/ngày (VNĐ) "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Pe,[e("input",{value:n.modelValue.price_per_day,onInput:l[2]||(l[2]=f=>u.$emit("update:modelValue",{...n.modelValue,price_per_day:f.target.value})),type:"number",step:"1000",min:"0",required:"",class:C(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.price_per_day?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"])},null,42,qe),e("span",Ee,g(k(n.modelValue.price_per_day)),1)]),n.errors.price_per_day?(i(),c("p",He,g(n.errors.price_per_day),1)):S("",!0)]),e("div",null,[l[10]||(l[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giá thuê/tuần (VNĐ) ",-1)),e("div",Re,[e("input",{value:n.modelValue.price_per_week,onInput:l[3]||(l[3]=f=>u.$emit("update:modelValue",{...n.modelValue,price_per_week:f.target.value})),type:"number",step:"1000",min:"0",class:C(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.price_per_week?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"]),placeholder:"Để trống nếu tính theo giá ngày × 7"},null,42,Le),e("span",ze,g(k(n.modelValue.price_per_week)),1)]),n.errors.price_per_week?(i(),c("p",Ge,g(n.errors.price_per_week),1)):S("",!0)]),e("div",null,[l[11]||(l[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giá thuê/tháng (VNĐ) ",-1)),e("div",We,[e("input",{value:n.modelValue.price_per_month,onInput:l[4]||(l[4]=f=>u.$emit("update:modelValue",{...n.modelValue,price_per_month:f.target.value})),type:"number",step:"1000",min:"0",class:C(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.price_per_month?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"]),placeholder:"Để trống nếu tính theo giá ngày × 30"},null,42,Ke),e("span",Xe,g(k(n.modelValue.price_per_month)),1)]),n.errors.price_per_month?(i(),c("p",Ye,g(n.errors.price_per_month),1)):S("",!0)]),e("div",null,[l[12]||(l[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Diện tích (m²)",-1)),e("input",{value:n.modelValue.area,onInput:l[5]||(l[5]=f=>u.$emit("update:modelValue",{...n.modelValue,area:f.target.value})),type:"number",step:"0.01",min:"0",class:C(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.area?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"])},null,42,Qe),n.errors.area?(i(),c("p",Je,g(n.errors.area),1)):S("",!0)]),e("div",null,[l[14]||(l[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Trạng thái "),e("span",{class:"text-red-500"},"*")],-1)),e("select",{value:n.modelValue.status,onChange:l[6]||(l[6]=f=>u.$emit("update:modelValue",{...n.modelValue,status:f.target.value})),required:"",class:C(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.errors.status?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"])},[...l[13]||(l[13]=[e("option",{value:"available"},"Trống",-1),e("option",{value:"active"},"Đang thuê",-1)])],42,Ze),n.errors.status?(i(),c("p",et,g(n.errors.status),1)):S("",!0)]),e("div",null,[l[15]||(l[15]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Tiện nghi "),e("span",{class:"text-xs text-gray-500 font-normal ml-2"}," (Kế thừa từ nhà trọ, có thể chỉnh sửa) ")],-1)),e("div",tt,[(i(),c(B,null,q(d,(f,V)=>e("label",{key:V,class:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-50 rounded"},[e("input",{checked:n.modelValue.amenities.includes(V),onChange:A=>s(V,A.target.checked),type:"checkbox",class:"rounded border-gray-300 text-primary focus:ring-primary"},null,40,rt),e("span",st,g(f),1)])),64))]),e("p",nt,[n.hasInheritedAmenities?(i(),c("span",at," ⓘ Đang hiển thị tiện nghi kế thừa từ nhà trọ ")):(i(),c("span",ot," ✓ Phòng có tiện nghi riêng "))])])]))}},it={class:"space-y-4"},dt={key:0,class:"space-y-2"},ut={class:"grid grid-cols-2 gap-3 max-h-96 overflow-y-auto border border-gray-200 rounded-lg p-3"},mt=["onClick"],ct=["src","alt"],gt={key:0,class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},pt={key:1,class:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},yt={key:0,class:"text-xs text-green-600 mt-2"},ht={key:1,class:"text-xs text-gray-500 mt-2"},ft={key:1,class:"text-center py-8 text-sm text-gray-500 border border-gray-200 rounded-lg"},vt={__name:"RoomImagesTab",props:{houseImages:{type:Array,default:()=>[]},selectedImages:{type:Array,default:()=>[]}},emits:["update:selectedImages"],setup(n,{emit:F}){const a=n,k=F,w=d=>a.selectedImages.includes(d),p=d=>{const s=[...a.selectedImages],u=s.indexOf(d);u>-1?s.splice(u,1):s.push(d),k("update:selectedImages",s)};return(d,s)=>(i(),c("div",it,[e("div",null,[s[4]||(s[4]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Hình ảnh phòng "),e("span",{class:"text-xs text-gray-500 font-normal ml-2"}," (Chọn từ ảnh đã upload của nhà trọ) ")],-1)),n.houseImages.length>0?(i(),c("div",dt,[s[2]||(s[2]=e("p",{class:"text-xs text-gray-500 mb-2"}," Nhấp vào ảnh để chọn hiển thị cho phòng này ",-1)),e("div",ut,[(i(!0),c(B,null,q(n.houseImages,(u,l)=>(i(),c("div",{key:l,class:"relative group cursor-pointer",onClick:f=>p(u)},[e("div",{class:C(["relative overflow-hidden rounded-lg border-2 transition-all",w(u)?"border-primary ring-2 ring-primary ring-offset-2":"border-gray-200 hover:border-gray-300"])},[e("img",{src:u,alt:`House image ${l+1}`,class:"w-full h-32 object-cover"},null,8,ct),e("div",{class:C(["absolute top-1 right-1 rounded-full p-1 shadow-lg transition-all duration-200",w(u)?"bg-primary text-white ring-2 ring-primary ring-offset-2":"bg-white text-gray-400 hover:bg-gray-50"])},[w(u)?(i(),c("svg",gt,[...s[0]||(s[0]=[e("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):(i(),c("svg",pt,[...s[1]||(s[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])]))],2)],2)],8,mt))),128))]),n.selectedImages.length>0?(i(),c("p",yt," Đã chọn "+g(n.selectedImages.length)+" ảnh cho phòng này ",1)):(i(),c("p",ht," Chưa chọn ảnh nào. Nhấp vào ảnh để chọn. "))])):(i(),c("div",ft,[...s[3]||(s[3]=[e("p",{class:"mb-2"},"Nhà trọ chưa có ảnh.",-1),e("p",{class:"text-xs"},"Vui lòng thêm ảnh cho nhà trọ trước khi chọn ảnh cho phòng.",-1)])]))])]))}},bt={class:"space-y-4"},xt={key:0,class:"bg-yellow-50 border border-yellow-200 rounded-lg p-4"},_t={key:1,class:"space-y-4"},$t={class:"pt-4 border-t"},kt={class:"flex items-center justify-between mb-4"},wt={key:0,class:"space-y-3"},Vt={key:0,class:"text-center py-8 text-sm text-gray-500 border border-gray-200 rounded-lg"},Ct={class:"flex items-start justify-between mb-2"},Tt={class:"font-medium text-gray-900"},St={class:"text-xs text-gray-500 mt-1"},At={class:"space-y-1 text-sm mt-3"},Nt={class:"flex justify-between"},Ft={class:"font-medium"},jt={class:"flex justify-between"},It={class:"font-medium"},Dt={key:0,class:"flex justify-between"},Mt={class:"font-medium"},Ot={class:"flex justify-between pt-2 border-t"},Bt={class:"font-bold text-primary"},Ut={key:0,class:"mt-2 text-xs text-gray-500"},Pt={class:"grid grid-cols-2 gap-4"},qt={class:"flex items-center gap-2"},Et={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},Ht={key:0,class:"mt-1 text-sm text-red-600"},Rt={class:"flex items-center gap-2"},Lt={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},zt={key:0,class:"mt-1 text-sm text-red-600"},Gt={class:"flex items-center gap-2"},Wt={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},Kt={key:0},Xt={key:1},Yt={__name:"TenantInfoTab",props:{form:{type:Object,required:!0},users:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})},room:{type:Object,default:null},house:{type:Object,required:!0},isActive:{type:Boolean,default:!1}},emits:["update:form"],setup(n,{emit:F}){const a=n,k=F,w=Q(),p=T({start_date:"",end_date:"",electricity_amount:0,water_amount:0,other_fees:0,due_date:"",notes:""}),d=T({}),s=T(!1),u=T(!1),l=T([]);H([()=>a.room,()=>a.form.tenant_id],async([t,r])=>{t?.id&&r?await f():l.value=[]},{immediate:!0}),H(()=>a.isActive,async t=>{t&&a.room?.id&&a.form.tenant_id&&await f()}),te(async()=>{a.isActive&&a.room?.id&&a.form.tenant_id&&await f()});const f=async()=>{if(!a.room?.id||!a.form.tenant_id){l.value=[];return}try{const t=await fetch(`/admin/houses/${a.house.id}/rooms/${a.room.id}/invoices`);if(t.ok){const r=await t.json();l.value=r.invoices||[]}}catch(t){console.error("Error loading invoices:",t),l.value=[]}},V=t=>t?new Intl.NumberFormat("vi-VN").format(t):"0",A=t=>!t||t===0?"":V(t)+" đ",M=t=>t?new Date(t).toLocaleDateString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric"}):"N/A",U=(t,r)=>!t||!r?"N/A":`${M(t)} - ${M(r)}`,o=t=>t?new Date(t).toLocaleString("vi-VN",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A",x=t=>{const r=a.users.find(m=>m.id===t);k("update:form",{...a.form,tenant_id:t,tenant_name:r?r.name:""})},h=()=>{if(a.room?.id){if(d.value={},!p.value.start_date){d.value.start_date="Vui lòng chọn ngày bắt đầu";return}if(!p.value.end_date){d.value.end_date="Vui lòng chọn ngày kết thúc";return}if(p.value.electricity_amount===null||p.value.electricity_amount<0){d.value.electricity_amount="Vui lòng nhập tiền điện";return}if(p.value.water_amount===null||p.value.water_amount<0){d.value.water_amount="Vui lòng nhập tiền nước";return}s.value=!0,P.post(`/admin/houses/${a.house.id}/rooms/${a.room.id}/invoices`,p.value,{preserveScroll:!0,onSuccess:()=>{w.success("Tạo hóa đơn điện nước thành công"),p.value={start_date:"",end_date:"",electricity_amount:0,water_amount:0,other_fees:0,due_date:"",notes:""},d.value={},s.value=!1,u.value=!1,f()},onError:t=>{w.error("Có lỗi xảy ra khi tạo hóa đơn"),d.value=t,s.value=!1}})}};return(t,r)=>(i(),c("div",bt,[n.form.status!=="active"?(i(),c("div",xt,[...r[10]||(r[10]=[e("p",{class:"text-sm text-yellow-800"},[e("span",{class:"font-medium"},"Lưu ý:"),$(' Phòng đang ở trạng thái "Trống". Để thêm khách thuê, vui lòng chuyển trạng thái phòng sang "Đang thuê" trong tab "Thông tin phòng trọ". ')],-1)])])):(i(),c("div",_t,[e("div",null,[r[11]||(r[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Người đang thuê "),e("span",{class:"text-red-500"},"*")],-1)),b(J,{"model-value":n.form.tenant_id,"onUpdate:modelValue":x,options:n.users,"option-value":"id","option-label":m=>`${m.name} (${m.email}${m.phone?" - "+m.phone:""})`,placeholder:"Tìm kiếm và chọn người thuê...",error:n.errors.tenant_id,hint:"Chọn tài khoản người dùng đang thuê phòng này"},null,8,["model-value","options","option-label","error"])]),e("div",null,[r[12]||(r[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Ngày bắt đầu thuê "),e("span",{class:"text-red-500"},"*")],-1)),b(E,{"model-value":n.form.rental_start_date,"onUpdate:modelValue":r[0]||(r[0]=m=>t.$emit("update:form",{...n.form,rental_start_date:m})),error:n.errors.rental_start_date,format:"dd/mm/yyyy",placeholder:"dd/mm/yyyy"},null,8,["model-value","error"])]),e("div",null,[r[13]||(r[13]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Ngày kết thúc thuê "),e("span",{class:"text-red-500"},"*")],-1)),b(E,{"model-value":n.form.rental_end_date,"onUpdate:modelValue":r[1]||(r[1]=m=>t.$emit("update:form",{...n.form,rental_end_date:m})),error:n.errors.rental_end_date,min:n.form.rental_start_date||void 0,format:"dd/mm/yyyy",placeholder:"dd/mm/yyyy"},null,8,["model-value","error","min"])]),e("div",$t,[e("div",kt,[r[14]||(r[14]=e("h3",{class:"text-lg font-semibold text-gray-900"},"Hóa đơn điện nước",-1)),e("button",{type:"button",onClick:r[2]||(r[2]=m=>u.value=!u.value),class:"text-sm text-primary hover:text-primary-600 font-medium"},g(u.value?"Xem danh sách":"Tạo hóa đơn mới"),1)]),u.value?(i(),c("form",{key:1,onSubmit:R(h,["prevent"]),class:"space-y-4"},[e("div",Pt,[e("div",null,[r[20]||(r[20]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Từ ngày "),e("span",{class:"text-red-500"},"*")],-1)),b(E,{modelValue:p.value.start_date,"onUpdate:modelValue":r[3]||(r[3]=m=>p.value.start_date=m),error:d.value.start_date,format:"dd/mm/yyyy",placeholder:"dd/mm/yyyy"},null,8,["modelValue","error"])]),e("div",null,[r[21]||(r[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Đến ngày "),e("span",{class:"text-red-500"},"*")],-1)),b(E,{modelValue:p.value.end_date,"onUpdate:modelValue":r[4]||(r[4]=m=>p.value.end_date=m),error:d.value.end_date,min:p.value.start_date||void 0,format:"dd/mm/yyyy",placeholder:"dd/mm/yyyy"},null,8,["modelValue","error","min"])])]),e("div",null,[r[22]||(r[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Tiền điện (VNĐ) "),e("span",{class:"text-red-500"},"*")],-1)),e("div",qt,[N(e("input",{"onUpdate:modelValue":r[5]||(r[5]=m=>p.value.electricity_amount=m),type:"number",min:"0",step:"1000",placeholder:"0",class:C(["flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",{"border-red-500":d.value.electricity_amount}])},null,2),[[O,p.value.electricity_amount,void 0,{number:!0}]]),e("span",Et,g(A(p.value.electricity_amount)),1)]),d.value.electricity_amount?(i(),c("p",Ht,g(d.value.electricity_amount),1)):S("",!0)]),e("div",null,[r[23]||(r[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Tiền nước (VNĐ) "),e("span",{class:"text-red-500"},"*")],-1)),e("div",Rt,[N(e("input",{"onUpdate:modelValue":r[6]||(r[6]=m=>p.value.water_amount=m),type:"number",min:"0",step:"1000",placeholder:"0",class:C(["flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",{"border-red-500":d.value.water_amount}])},null,2),[[O,p.value.water_amount,void 0,{number:!0}]]),e("span",Lt,g(A(p.value.water_amount)),1)]),d.value.water_amount?(i(),c("p",zt,g(d.value.water_amount),1)):S("",!0)]),e("div",null,[r[24]||(r[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Phí khác (VNĐ) ",-1)),e("div",Gt,[N(e("input",{"onUpdate:modelValue":r[7]||(r[7]=m=>p.value.other_fees=m),type:"number",min:"0",step:"1000",placeholder:"0",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},null,512),[[O,p.value.other_fees,void 0,{number:!0}]]),e("span",Wt,g(A(p.value.other_fees)),1)])]),e("div",null,[r[25]||(r[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Ngày đến hạn ",-1)),b(E,{modelValue:p.value.due_date,"onUpdate:modelValue":r[8]||(r[8]=m=>p.value.due_date=m),error:d.value.due_date,format:"dd/mm/yyyy",placeholder:"dd/mm/yyyy"},null,8,["modelValue","error"])]),e("div",null,[r[26]||(r[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Ghi chú ",-1)),N(e("textarea",{"onUpdate:modelValue":r[9]||(r[9]=m=>p.value.notes=m),rows:"3",placeholder:"Nhập ghi chú (nếu có)...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},null,512),[[O,p.value.notes]])]),b(L,{type:"submit",disabled:s.value,class:"w-full"},{default:D(()=>[s.value?(i(),c("span",Kt,"Đang tạo...")):(i(),c("span",Xt,"Tạo hóa đơn"))]),_:1},8,["disabled"])],32)):(i(),c("div",wt,[l.value.length===0?(i(),c("div",Vt,[...r[15]||(r[15]=[e("p",null,"Chưa có hóa đơn nào",-1)])])):S("",!0),(i(!0),c(B,null,q(l.value,m=>(i(),c("div",{key:m.id,class:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors"},[e("div",Ct,[e("div",null,[e("p",Tt,g(U(m.start_date,m.end_date)),1),e("p",St," Ngày đến hạn: "+g(m.due_date?M(m.due_date):"N/A"),1)]),e("span",{class:C(["px-2 py-1 rounded-full text-xs font-medium",m.status==="paid"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"])},g(m.status==="paid"?"Đã thanh toán":"Chưa thanh toán"),3)]),e("div",At,[e("div",Nt,[r[16]||(r[16]=e("span",{class:"text-gray-600"},"Tiền điện:",-1)),e("span",Ft,g(V(m.electricity_amount))+" VNĐ",1)]),e("div",jt,[r[17]||(r[17]=e("span",{class:"text-gray-600"},"Tiền nước:",-1)),e("span",It,g(V(m.water_amount))+" VNĐ",1)]),m.other_fees>0?(i(),c("div",Dt,[r[18]||(r[18]=e("span",{class:"text-gray-600"},"Phí khác:",-1)),e("span",Mt,g(V(m.other_fees))+" VNĐ",1)])):S("",!0),e("div",Ot,[r[19]||(r[19]=e("span",{class:"font-semibold text-gray-900"},"Tổng cộng:",-1)),e("span",Bt,g(V(m.total))+" VNĐ",1)])]),m.paid_at?(i(),c("div",Ut," Đã thanh toán: "+g(o(m.paid_at)),1)):S("",!0)]))),128))]))])]))]))}},Qt={class:"flex flex-col h-full"},Jt={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-6 py-4"},Zt={class:"text-lg font-semibold text-gray-900"},er={class:"flex-1 overflow-y-auto p-6"},tr={class:"border-b border-gray-200 mb-6"},rr={class:"-mb-px flex space-x-8","aria-label":"Tabs"},sr={class:"flex gap-3 pt-4 border-t"},nr={__name:"RoomForm",props:{room:Object,house:Object,users:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},emits:["close"],setup(n,{emit:F}){const a=n,k=F,w=Q(),p=me(),d=T("room"),s=T({room_number:"",floor:1,price_per_day:"",price_per_week:"",price_per_month:"",status:"available",area:"",amenities:[],images:[],tenant_name:"",tenant_id:null,rental_start_date:"",rental_end_date:""}),u=T(!1),l=T([]),f=G(()=>a.house?.images?Array.isArray(a.house.images)?a.house.images.filter(o=>o&&o.trim()!==""):[]:[]),V=G(()=>{if(!a.room)return!1;const o=a.room.amenities;return!o||!Array.isArray(o)||o.length===0});H(()=>a.room,o=>{if(o){d.value="room";const x=o.amenities&&Array.isArray(o.amenities)&&o.amenities.length>0?o.amenities:a.house?.amenities||[],h=o.images&&Array.isArray(o.images)&&o.images.length>0?o.images.filter(r=>r&&r.trim()!==""):[];l.value=[...h];const t=r=>{if(!r)return"";const m=new Date(r),y=m.getFullYear(),v=String(m.getMonth()+1).padStart(2,"0"),_=String(m.getDate()).padStart(2,"0");return`${y}-${v}-${_}`};s.value={room_number:o.room_number||"",floor:o.floor||1,price_per_day:o.price_per_day||"",price_per_week:o.price_per_week||"",price_per_month:o.price_per_month||"",status:o.status||"available",area:o.area||"",amenities:x,images:h,tenant_name:o.tenant_name||"",tenant_id:o.tenant_id||null,rental_start_date:t(o.rental_start_date),rental_end_date:t(o.rental_end_date)}}else l.value=[]},{immediate:!0});const A=o=>{l.value=o,s.value.images=[...o]};H(()=>s.value.status,o=>{o!=="active"?(s.value.tenant_id=null,s.value.tenant_name="",s.value.rental_start_date="",s.value.rental_end_date="",d.value==="tenant"&&(d.value="room")):d.value="tenant"});const M=async()=>{if(d.value==="tenant")try{await p.show({title:"Cập nhật thông tin khách thuê",message:"Bạn có chắc chắn muốn cập nhật thông tin khách thuê? Hành động này có thể ảnh hưởng đến các hóa đơn và đặt phòng liên quan.",confirmText:"Cập nhật",cancelText:"Hủy",confirmVariant:"primary"})}catch(t){t.message!=="USER_CANCELLED"&&console.error("Error showing confirm dialog:",t);return}u.value=!0;let o={};if(d.value==="room"){if(o={room_number:s.value.room_number,floor:s.value.floor,price_per_day:s.value.price_per_day,status:s.value.status,area:s.value.area,amenities:s.value.amenities},s.value.status!=="active")o.tenant_id=null,o.tenant_name=null,o.rental_start_date=null,o.rental_end_date=null;else if(a.room?.tenant_id){if(o.tenant_id=a.room.tenant_id,o.tenant_name=a.room.tenant_name,a.room.rental_start_date){const t=new Date(a.room.rental_start_date);o.rental_start_date=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}if(a.room.rental_end_date){const t=new Date(a.room.rental_end_date);o.rental_end_date=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}}}else if(d.value==="images"){if(o={room_number:s.value.room_number,floor:s.value.floor,price_per_day:s.value.price_per_day,status:s.value.status,area:s.value.area,amenities:s.value.amenities,images:[...l.value]},s.value.status==="active"&&a.room?.tenant_id){if(o.tenant_id=a.room.tenant_id,o.tenant_name=a.room.tenant_name,a.room.rental_start_date){const t=new Date(a.room.rental_start_date);o.rental_start_date=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}if(a.room.rental_end_date){const t=new Date(a.room.rental_end_date);o.rental_end_date=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}}}else d.value==="tenant"&&(o={room_number:s.value.room_number,floor:s.value.floor,price_per_day:s.value.price_per_day,status:s.value.status,tenant_id:s.value.tenant_id,tenant_name:s.value.tenant_name,rental_start_date:s.value.rental_start_date,rental_end_date:s.value.rental_end_date});const h={room:"Cập nhật thông tin phòng thành công",images:"Cập nhật hình ảnh phòng thành công",tenant:"Cập nhật thông tin khách thuê thành công"}[d.value]||"Cập nhật thành công";P.put(`/admin/houses/${a.house.id}/rooms/${a.room.id}`,o,{preserveScroll:!0,onSuccess:()=>{w.success(h)},onError:()=>{w.error("Có lỗi xảy ra khi cập nhật")},onFinish:()=>{u.value=!1}})},U=async()=>{try{await p.show({title:"Xóa phòng",message:"Bạn có chắc chắn muốn xóa phòng này? Hành động này không thể hoàn tác.",confirmText:"Xóa",cancelText:"Hủy",confirmVariant:"danger"}),P.delete(`/admin/houses/${a.house.id}/rooms/${a.room.id}`,{preserveScroll:!0,onSuccess:()=>{k("close")}})}catch(o){o.message!=="USER_CANCELLED"&&console.error("Error showing confirm dialog:",o)}};return(o,x)=>(i(),K(Ie,{"is-open":!!n.room,onClose:x[6]||(x[6]=h=>o.$emit("close"))},{default:D(()=>[e("div",Qt,[e("div",Jt,[e("h3",Zt,g(n.room?`Thông tin phòng ${n.room.room_number}`:"Thông tin phòng"),1),e("button",{onClick:x[0]||(x[0]=h=>o.$emit("close")),class:"text-gray-400 hover:text-gray-600 transition-colors"},[b(j(ue),{class:"h-5 w-5"})])]),e("div",er,[e("div",tr,[e("nav",rr,[e("button",{type:"button",onClick:x[1]||(x[1]=h=>d.value="room"),class:C(["py-2 px-1 border-b-2 font-medium text-sm transition-colors whitespace-nowrap",d.value==="room"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Thông tin phòng trọ ",2),e("button",{type:"button",onClick:x[2]||(x[2]=h=>d.value="images"),class:C(["py-2 px-1 border-b-2 font-medium text-sm transition-colors whitespace-nowrap",d.value==="images"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Hình ảnh ",2),e("button",{type:"button",onClick:x[3]||(x[3]=h=>d.value="tenant"),class:C(["py-2 px-1 border-b-2 font-medium text-sm transition-colors whitespace-nowrap",d.value==="tenant"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])}," Khách thuê ",2)])]),e("form",{onSubmit:R(M,["prevent"]),class:"space-y-4"},[N(b(lt,{modelValue:s.value,"onUpdate:modelValue":x[4]||(x[4]=h=>s.value=h),house:n.house,errors:n.errors,"has-inherited-amenities":V.value},null,8,["modelValue","house","errors","has-inherited-amenities"]),[[z,d.value==="room"]]),N(b(vt,{"house-images":f.value,"selected-images":l.value,"onUpdate:selectedImages":A},null,8,["house-images","selected-images"]),[[z,d.value==="images"]]),N(b(Yt,{form:s.value,users:n.users,errors:n.errors,room:n.room,house:n.house,"is-active":d.value==="tenant","onUpdate:form":x[5]||(x[5]=h=>s.value=h)},null,8,["form","users","errors","room","house","is-active"]),[[z,d.value==="tenant"]]),e("div",sr,[b(L,{type:"button",variant:"outline",onClick:U,class:"flex-1"},{default:D(()=>[...x[7]||(x[7]=[$(" Xóa phòng ",-1)])]),_:1}),b(L,{type:"submit",disabled:u.value,class:"flex-1"},{default:D(()=>[$(g(u.value?"Đang lưu...":"Lưu thay đổi"),1)]),_:1},8,["disabled"])])],32)])])]),_:1},8,["is-open"]))}},ar={class:"space-y-6"},or={class:"flex items-center justify-between"},lr={class:"text-2xl font-bold text-gray-900"},ir={class:"text-gray-600 mt-1"},dr={class:"flex items-center justify-center min-h-screen px-4"},ur={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6"},mr={class:"text-sm text-gray-600 mb-4"},cr={class:"font-semibold text-primary"},gr={class:"space-y-4"},pr={class:"flex items-center gap-2"},yr={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},hr={class:"flex items-center gap-2"},fr={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},vr={class:"flex items-center gap-2"},br={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},xr={key:0},_r={class:"grid grid-cols-2 gap-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-3"},$r=["value"],kr={class:"text-sm text-gray-700"},wr={class:"flex justify-end gap-3 mt-6"},Vr=["disabled"],Gr={__name:"Manage",props:{house:Object,roomsByFloor:Object,users:{type:Array,default:()=>[]},errors:{type:Object,default:()=>({})}},setup(n){const F=ce,a=n,k=T(null),w=T(!1),p=T(!1),d=T(null),s=T({room_number:"",floor:1,price_per_day:"",price_per_week:"",price_per_month:"",status:"available",amenities:[],tenant_id:null,tenant_name:""}),u=h=>h?new Intl.NumberFormat("vi-VN").format(h):"0",l=h=>!h||h===0?"":u(h)+" đ",f=h=>{k.value=h},V=h=>{h?s.value.floor=h:s.value.floor=1,s.value.price_per_day=a.house.price_per_day||"",s.value.price_per_week=a.house.price_per_week||"",s.value.price_per_month=a.house.price_per_month||"",s.value.amenities=a.house.amenities?[...a.house.amenities]:[],w.value=!0},A=()=>{w.value=!1,s.value={room_number:"",floor:1,price_per_day:"",price_per_week:"",price_per_month:"",status:"available",amenities:[],tenant_id:null,tenant_name:""},d.value&&(d.value.newRoomFloor=null)},M=()=>{if(s.value.tenant_id){const h=a.users.find(t=>t.id===s.value.tenant_id);h&&(s.value.tenant_name=h.name)}else s.value.tenant_name=""},U=()=>{p.value=!0,P.post(`/admin/houses/${a.house.id}/rooms`,s.value,{preserveScroll:!0,onSuccess:()=>{A()},onFinish:()=>{p.value=!1}})},o=()=>{confirm("Bạn có chắc chắn muốn thêm tầng mới?")&&P.post(`/admin/houses/${a.house.id}/floors`,{},{preserveScroll:!0})},x=h=>{confirm(`Bạn có chắc chắn muốn xóa tầng ${h}? Các phòng ở tầng trên sẽ được di chuyển xuống.`)&&P.delete(`/admin/houses/${a.house.id}/floors`,{data:{floor:h},preserveScroll:!0})};return(h,t)=>(i(),c(B,null,[b(j(re),{title:"Quản lý Phòng"}),b(le,{title:"Quản lý Phòng"},{default:D(()=>[e("div",ar,[e("div",or,[e("div",null,[b(j(se),{href:"/admin/houses",class:"text-primary hover:text-primary-600 mb-2 inline-flex items-center text-sm"},{default:D(()=>[b(j(ge),{class:"h-4 w-4 mr-1"}),t[8]||(t[8]=$(" Quay lại danh sách ",-1))]),_:1}),e("h1",lr,g(n.house.name),1),e("p",ir,g(n.house.address),1)])]),e("div",null,[b(je,{ref_key:"roomDiagramRef",ref:d,"rooms-by-floor":n.roomsByFloor,house:n.house,onSelectRoom:f,onAddRoom:V,onAddFloor:o,onDeleteFloor:x},null,8,["rooms-by-floor","house"])]),b(nr,{room:k.value,house:n.house,users:n.users,errors:n.errors,onClose:t[0]||(t[0]=r=>k.value=null)},null,8,["room","house","users","errors"]),w.value?(i(),c("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:R(A,["self"])},[e("div",dr,[e("div",{class:"fixed inset-0 bg-black opacity-50",onClick:A}),e("div",ur,[t[21]||(t[21]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"Thêm phòng mới",-1)),e("p",mr,[t[9]||(t[9]=$("Tầng: ",-1)),e("span",cr,"Tầng "+g(s.value.floor),1)]),e("form",{onSubmit:R(U,["prevent"])},[e("div",gr,[e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Số phòng "),e("span",{class:"text-red-500"},"*")],-1)),N(e("input",{"onUpdate:modelValue":t[1]||(t[1]=r=>s.value.room_number=r),type:"text",required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"101"},null,512),[[O,s.value.room_number]])]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Giá thuê/ngày (VNĐ) "),e("span",{class:"text-red-500"},"*")],-1)),e("div",pr,[N(e("input",{"onUpdate:modelValue":t[2]||(t[2]=r=>s.value.price_per_day=r),type:"number",step:"1000",min:"0",required:"",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"500000"},null,512),[[O,s.value.price_per_day,void 0,{number:!0}]]),e("span",yr,g(l(s.value.price_per_day)),1)])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giá thuê/tuần (VNĐ) ",-1)),e("div",hr,[N(e("input",{"onUpdate:modelValue":t[3]||(t[3]=r=>s.value.price_per_week=r),type:"number",step:"1000",min:"0",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"3000000"},null,512),[[O,s.value.price_per_week,void 0,{number:!0}]]),e("span",fr,g(l(s.value.price_per_week)),1)]),t[13]||(t[13]=e("p",{class:"mt-1 text-xs text-gray-500"},"Để trống nếu tính theo giá ngày × 7",-1))]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Giá thuê/tháng (VNĐ) ",-1)),e("div",vr,[N(e("input",{"onUpdate:modelValue":t[4]||(t[4]=r=>s.value.price_per_month=r),type:"number",step:"1000",min:"0",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"12000000"},null,512),[[O,s.value.price_per_month,void 0,{number:!0}]]),e("span",br,g(l(s.value.price_per_month)),1)]),t[15]||(t[15]=e("p",{class:"mt-1 text-xs text-gray-500"},"Để trống nếu tính theo giá ngày × 30",-1))]),e("div",null,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Trạng thái "),e("span",{class:"text-red-500"},"*")],-1)),N(e("select",{"onUpdate:modelValue":t[5]||(t[5]=r=>s.value.status=r),required:"",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"},[...t[16]||(t[16]=[e("option",{value:"available"},"Trống",-1),e("option",{value:"active"},"Đang thuê",-1)])],512),[[ne,s.value.status]])]),s.value.status==="active"?(i(),c("div",xr,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[$(" Người đang thuê "),e("span",{class:"text-red-500"},"*")],-1)),b(J,{modelValue:s.value.tenant_id,"onUpdate:modelValue":[t[6]||(t[6]=r=>s.value.tenant_id=r),M],options:n.users,"option-value":"id","option-label":r=>`${r.name} (${r.email}${r.phone?" - "+r.phone:""})`,placeholder:"Tìm kiếm và chọn người thuê...",hint:"Chọn tài khoản người dùng đang thuê phòng này"},null,8,["modelValue","options","option-label"])])):S("",!0),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Tiện nghi",-1)),e("div",_r,[(i(!0),c(B,null,q(j(F),(r,m)=>(i(),c("label",{key:m,class:"flex items-center space-x-2 cursor-pointer p-2 hover:bg-gray-50 rounded"},[N(e("input",{"onUpdate:modelValue":t[7]||(t[7]=y=>s.value.amenities=y),type:"checkbox",value:m,class:"rounded border-gray-300 text-primary focus:ring-primary"},null,8,$r),[[ae,s.value.amenities]]),e("span",kr,g(r),1)]))),128))]),t[20]||(t[20]=e("p",{class:"mt-1 text-xs text-gray-500"},"Tiện nghi đã được kế thừa từ nhà trọ, bạn có thể chỉnh sửa",-1))])]),e("div",wr,[e("button",{type:"button",onClick:A,class:"px-4 py-2 border-2 border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"}," Hủy "),e("button",{type:"submit",disabled:p.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},g(p.value?"Đang thêm...":"Thêm phòng"),9,Vr)])],32)])])])):S("",!0)])]),_:1})],64))}};export{Gr as default};
