import{r as $,A as k,B as re,z as ne,L as oe,c as f,d as o,a as w,e as _,g as F,v as ie,n as E,k as ce,b as B,w as de,o as g,F as T,i as C,t as b,j as N,T as ue,V as P}from"./app-Ce3tobvh.js";import{r as ye}from"./CalendarIcon-DWu-TwN1.js";import{r as me}from"./ChevronLeftIcon-DZM0ZSRG.js";import{r as fe}from"./ChevronRightIcon-BFcsHXDl.js";const ge={class:"relative"},pe={class:"relative"},he=["placeholder","disabled"],ve=["disabled"],$e={class:"flex items-center justify-between mb-4"},be={class:"flex items-center space-x-2"},De=["value"],xe=["value"],ke={class:"grid grid-cols-7 gap-1 mb-2"},we={class:"grid grid-cols-7 gap-1"},Te=["onClick"],Ce={key:0,class:"mt-1 text-sm text-red-600"},Ve={key:1,class:"mt-1 text-xs text-gray-500"},Fe={__name:"DatePicker",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:""},format:{type:String,default:"dd/mm/yyyy",validator:y=>["dd/mm/yyyy","mm/dd/yyyy","yyyy-mm-dd","dd-mm-yyyy","mm-dd-yyyy"].includes(y)},error:{type:String,default:""},hint:{type:String,default:""},disabled:{type:Boolean,default:!1},min:{type:String,default:""},max:{type:String,default:""}},emits:["update:modelValue"],setup(y,{emit:U}){const r=y,h=U,x=$(null),V=$(null),v=$(!1),d=$(new Date().getMonth()),p=$(new Date().getFullYear()),m=$(""),j=["CN","T2","T3","T4","T5","T6","T7"],z=["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],O=k(()=>{const e=new Date().getFullYear(),a=[];for(let t=e-10;t<=e+10;t++)a.push(t);return a}),A=k(()=>r.placeholder?r.placeholder:r.format),Y=k(()=>r.format.includes("/")?"/":"-"),H=e=>{if(!e)return"";const a=e.replace(/\D/g,"");if(a.length===0)return"";const t=Y.value,l=(r.format==="yyyy-mm-dd",8),s=a.slice(0,l);switch(r.format){case"dd/mm/yyyy":case"dd-mm-yyyy":return s.length<=2?s:s.length<=4?`${s.slice(0,2)}${t}${s.slice(2)}`:`${s.slice(0,2)}${t}${s.slice(2,4)}${t}${s.slice(4,8)}`;case"mm/dd/yyyy":case"mm-dd-yyyy":return s.length<=2?s:s.length<=4?`${s.slice(0,2)}${t}${s.slice(2)}`:`${s.slice(0,2)}${t}${s.slice(2,4)}${t}${s.slice(4,8)}`;case"yyyy-mm-dd":return s.length<=4?s:s.length<=6?`${s.slice(0,4)}${t}${s.slice(4)}`:`${s.slice(0,4)}${t}${s.slice(4,6)}${t}${s.slice(6,8)}`;default:return s.length<=2?s:s.length<=4?`${s.slice(0,2)}${t}${s.slice(2)}`:`${s.slice(0,2)}${t}${s.slice(2,4)}${t}${s.slice(4,8)}`}},I=(e,a,t)=>{const l=String(e).padStart(2,"0"),s=String(a+1).padStart(2,"0");return`${t}-${s}-${l}`},D=e=>{if(!e||!/^\d{4}-\d{2}-\d{2}$/.test(e))return"";const[a,t,l]=e.split("-"),s=Y.value;switch(r.format){case"dd/mm/yyyy":case"dd-mm-yyyy":return`${l}${s}${t}${s}${a}`;case"mm/dd/yyyy":case"mm-dd-yyyy":return`${t}${s}${l}${s}${a}`;case"yyyy-mm-dd":return`${a}${s}${t}${s}${l}`;default:return`${l}${s}${t}${s}${a}`}},K=(e,a,t)=>{if(!e&&!a&&!t)return h("update:modelValue",""),!1;if(!e||!a||!t||e<1||e>31||a<1||a>12||t<1900||t>2100)return!1;const l=new Date(t,a-1,e);if(l.getDate()!==e||l.getMonth()!==a-1||l.getFullYear()!==t)return!1;const s=I(e,a-1,t),i=new Date(s+"T00:00:00");if(r.min){const n=new Date(r.min+"T00:00:00");if(i<n)return!1}if(r.max){const n=new Date(r.max+"T00:00:00");if(i>n)return!1}return h("update:modelValue",s),!0},q=e=>{const a=e.target.selectionStart,t=e.target.value,l=H(t);m.value=l,P(()=>{if(x.value){const i=t.slice(0,a).replace(/\D/g,"").length;let n=0,c=0;for(let u=0;u<l.length&&c<i;u++)/\d/.test(l[u])&&c++,n=u+1;c<i&&(n=l.length),x.value.setSelectionRange(n,n)}});const s=l.replace(/\D/g,"");if(s.length===8){let i,n,c;switch(r.format){case"dd/mm/yyyy":case"dd-mm-yyyy":i=parseInt(s.slice(0,2),10),n=parseInt(s.slice(2,4),10),c=parseInt(s.slice(4,8),10);break;case"mm/dd/yyyy":case"mm-dd-yyyy":n=parseInt(s.slice(0,2),10),i=parseInt(s.slice(2,4),10),c=parseInt(s.slice(4,8),10);break;case"yyyy-mm-dd":c=parseInt(s.slice(0,4),10),n=parseInt(s.slice(4,6),10),i=parseInt(s.slice(6,8),10);break}i&&n&&c&&K(i,n,c)}else l.length===0&&h("update:modelValue","")},G=()=>{if(!m.value){h("update:modelValue","");return}const e=m.value.replace(/\D/g,"");if(e.length===8){let a,t,l;switch(r.format){case"dd/mm/yyyy":case"dd-mm-yyyy":a=parseInt(e.slice(0,2),10),t=parseInt(e.slice(2,4),10),l=parseInt(e.slice(4,8),10);break;case"mm/dd/yyyy":case"mm-dd-yyyy":t=parseInt(e.slice(0,2),10),a=parseInt(e.slice(2,4),10),l=parseInt(e.slice(4,8),10);break;case"yyyy-mm-dd":l=parseInt(e.slice(0,4),10),t=parseInt(e.slice(4,6),10),a=parseInt(e.slice(6,8),10);break}a&&t&&l&&K(a,t,l),m.value=D(r.modelValue)}else m.value=D(r.modelValue)},J=e=>{[8,9,27,13,46,37,38,39,40].includes(e.keyCode)||e.keyCode===65&&e.ctrlKey===!0||e.keyCode===67&&e.ctrlKey===!0||e.keyCode===86&&e.ctrlKey===!0||e.keyCode===88&&e.ctrlKey===!0||e.keyCode>=35&&e.keyCode<=39||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()},Q=k(()=>{const e=[],a=new Date(p.value,d.value,1);new Date(p.value,d.value+1,0);const t=new Date(a);t.setDate(t.getDate()-a.getDay());const l=r.modelValue?new Date(r.modelValue+"T00:00:00"):null,s=new Date;s.setHours(0,0,0,0);const i=r.min?new Date(r.min+"T00:00:00"):null,n=r.max?new Date(r.max+"T00:00:00"):null;for(let c=0;c<42;c++){const u=new Date(t);u.setDate(t.getDate()+c);const se=u.getMonth()===d.value,ae=u.getTime()===s.getTime(),le=l&&u.getTime()===l.getTime();let M=!1;i&&u<i&&(M=!0),n&&u>n&&(M=!0),e.push({key:c,date:u.getDate(),fullDate:u,isCurrentMonth:se,isToday:ae,isSelected:le,isDisabled:M})}return e}),W=async()=>{if(!r.disabled&&(v.value=!v.value,v.value&&(await P(),r.modelValue))){const e=new Date(r.modelValue+"T00:00:00");d.value=e.getMonth(),p.value=e.getFullYear()}},S=()=>{v.value=!1},X=e=>{if(e.isDisabled||!e.isCurrentMonth)return;const a=I(e.date,e.fullDate.getMonth(),e.fullDate.getFullYear());h("update:modelValue",a),S()},Z=()=>{const e=new Date,a=I(e.getDate(),e.getMonth(),e.getFullYear());h("update:modelValue",a),S()},ee=()=>{d.value===0?(d.value=11,p.value--):d.value--},te=()=>{d.value===11?(d.value=0,p.value++):d.value++},L=()=>{};re(()=>r.modelValue,e=>{if(e){const a=new Date(e+"T00:00:00");d.value=a.getMonth(),p.value=a.getFullYear();const t=D(e);m.value!==t&&(m.value=t)}else m.value=""},{immediate:!0});const R=e=>{v.value&&V.value&&!V.value.contains(e.target)&&!x.value?.contains(e.target)&&!e.target.closest("button")&&S()};return ne(()=>{document.addEventListener("click",R)}),oe(()=>{document.removeEventListener("click",R)}),(e,a)=>(g(),f("div",ge,[o("div",pe,[F(o("input",{ref_key:"inputRef",ref:x,"onUpdate:modelValue":a[0]||(a[0]=t=>m.value=t),type:"text",placeholder:y.placeholder||A.value,class:E(["w-full px-4 py-2 pr-10 border rounded-lg focus:ring-2 focus:outline-none transition-colors",y.error?"border-red-500 focus:ring-red-500":"border-gray-300 focus:ring-primary"]),disabled:y.disabled,onInput:q,onBlur:G,onKeydown:J},null,42,he),[[ie,m.value]]),o("button",{type:"button",onClick:ce(W,["stop"]),disabled:y.disabled,class:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400 hover:text-gray-600 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed"},[w(B(ye),{class:"h-5 w-5"})],8,ve)]),w(ue,{"enter-active-class":"transition ease-out duration-100","enter-from-class":"transform opacity-0 scale-95","enter-to-class":"transform opacity-100 scale-100","leave-active-class":"transition ease-in duration-75","leave-from-class":"transform opacity-100 scale-100","leave-to-class":"transform opacity-0 scale-95"},{default:de(()=>[v.value?(g(),f("div",{key:0,ref_key:"calendarRef",ref:V,class:"absolute z-50 mt-2 bg-white rounded-lg shadow-lg border border-gray-200 p-4 w-80"},[o("div",$e,[o("button",{type:"button",onClick:ee,class:"p-1 hover:bg-gray-100 rounded"},[w(B(me),{class:"h-5 w-5 text-gray-600"})]),o("div",be,[F(o("select",{"onUpdate:modelValue":a[1]||(a[1]=t=>d.value=t),onChange:L,class:"text-sm font-semibold text-gray-900 border-none focus:ring-0 cursor-pointer"},[(g(),f(T,null,C(z,(t,l)=>o("option",{key:l,value:l},b(t),9,De)),64))],544),[[N,d.value,void 0,{number:!0}]]),F(o("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>p.value=t),onChange:L,class:"text-sm font-semibold text-gray-900 border-none focus:ring-0 cursor-pointer"},[(g(!0),f(T,null,C(O.value,t=>(g(),f("option",{key:t,value:t},b(t),9,xe))),128))],544),[[N,p.value,void 0,{number:!0}]])]),o("button",{type:"button",onClick:te,class:"p-1 hover:bg-gray-100 rounded"},[w(B(fe),{class:"h-5 w-5 text-gray-600"})])]),o("div",ke,[(g(),f(T,null,C(j,t=>o("div",{key:t,class:"text-center text-xs font-medium text-gray-500 py-1"},b(t),1)),64))]),o("div",we,[(g(!0),f(T,null,C(Q.value,t=>(g(),f("div",{key:t.key,class:E(["text-center py-2 rounded cursor-pointer text-sm transition-colors",t.isCurrentMonth?t.isSelected?"bg-primary text-white font-semibold":t.isToday?"bg-primary/10 text-primary font-semibold":t.isDisabled?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100":"text-gray-300"]),onClick:l=>X(t)},b(t.date),11,Te))),128))]),o("div",{class:"mt-4 pt-4 border-t"},[o("button",{type:"button",onClick:Z,class:"w-full text-sm text-primary hover:text-primary-600 font-medium"}," Hôm nay ")])],512)):_("",!0)]),_:1}),y.error?(g(),f("p",Ce,b(y.error),1)):_("",!0),y.hint&&!y.error?(g(),f("p",Ve,b(y.hint),1)):_("",!0)]))}};export{Fe as _};
