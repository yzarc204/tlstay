import{c as l,d as e,o,u as X,r as c,a as g,b as p,h as Z,w as _,e as u,f as i,g as x,v as w,j as z,F as $,i as q,t as n,n as E,q as U,y as F,k as B,l as C}from"./app-CH4CEp7f.js";import{a as G,_ as J}from"./AdminLayout-BT6D36Nk.js";import{_ as W}from"./Button-BzBTj2yc.js";import{r as Y}from"./PlusIcon-CH2wYw7X.js";import{r as ee}from"./EyeIcon-CHZ1M4j4.js";import{r as te}from"./LockClosedIcon-DZu-PUC_.js";/* empty css            */import"./FlashToaster-Co9bFWRi.js";import"./MapPinIcon-A7TLZLbH.js";import"./CalendarIcon-DL8s8YjY.js";import"./PhotoIcon-CGQz7Bxq.js";import"./BuildingOfficeIcon-BvyATTDh.js";function se(a,T){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13.5 10.5V6.75a4.5 4.5 0 1 1 9 0v3.75M3.75 21.75h10.5a2.25 2.25 0 0 0 2.25-2.25v-6.75a2.25 2.25 0 0 0-2.25-2.25H3.75a2.25 2.25 0 0 0-2.25 2.25v6.75a2.25 2.25 0 0 0 2.25 2.25Z"})])}const re={class:"space-y-6"},oe={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},le={class:"bg-white rounded-lg shadow-sm p-4"},ae={class:"grid grid-cols-1 md:grid-cols-4 gap-4"},ne={class:"md:col-span-2"},ie={class:"bg-white rounded-lg shadow-sm overflow-hidden"},de={class:"overflow-x-auto"},ue={class:"min-w-full divide-y divide-gray-200"},me={class:"bg-white divide-y divide-gray-200"},ce={class:"px-6 py-4 whitespace-nowrap"},pe={class:"flex items-center"},ge={class:"flex-shrink-0 h-10 w-10"},xe=["src","alt","onError"],fe={class:"ml-4"},ve={class:"text-sm font-medium text-gray-900"},he={class:"text-sm text-gray-500"},ye={key:0,class:"text-xs text-gray-400"},be={class:"px-6 py-4 whitespace-nowrap"},we={class:"px-6 py-4 whitespace-nowrap"},ke={key:0,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800"},_e={key:1,class:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800"},Ce={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},Te={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},je={class:"px-6 py-4 whitespace-nowrap"},Me={class:"flex items-center justify-start gap-2"},Ve={class:"relative group"},Se={key:0,class:"relative group"},$e=["onClick"],Ue=["onClick"],Be={class:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 text-xs font-medium text-white bg-gray-900 rounded shadow-lg whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none z-50"},He={key:0,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},ze={class:"flex items-center justify-between"},Fe={class:"flex-1 flex justify-between sm:hidden"},Ke={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Ne={class:"text-sm text-gray-700"},qe={class:"font-medium"},Ee={class:"font-medium"},Le={class:"font-medium"},Qe={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},De=["innerHTML"],Ie={key:1,class:"text-center py-12"},Re={class:"flex items-center justify-center min-h-screen px-4"},Ae={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6"},Oe={class:"space-y-4"},Pe={key:0,class:"mt-1 text-sm text-red-600"},Xe={key:0,class:"mt-1 text-sm text-red-600"},Ze={key:0,class:"mt-1 text-sm text-red-600"},Ge={key:0,class:"mt-1 text-sm text-red-600"},Je={key:0,class:"mt-1 text-sm text-red-600"},We={class:"flex justify-end gap-3 mt-6"},Ye=["disabled"],et={class:"flex items-center justify-center min-h-screen px-4"},tt={class:"relative bg-white rounded-lg shadow-xl max-w-md w-full p-6"},st={class:"mb-4"},rt={class:"flex justify-end gap-3"},ot=["disabled"],vt={__name:"Index",props:{users:Object,filters:Object},setup(a){const T=a;X();const h=c(T.filters.search||""),y=c(T.filters.role||""),b=c(T.filters.status||""),H=c(!1),k=c(null),f=c(""),j=c(!1),M=c(!1),m=c({name:"",email:"",phone:"",password:"",role:"customer"}),d=c({});let K=null;const L=()=>{clearTimeout(K),K=setTimeout(()=>{const r={};h.value&&(r.search=h.value),y.value&&(r.role=y.value),b.value&&(r.status=b.value),C.get("/admin/users",r,{preserveState:!0,replace:!0})},300)},N=()=>{const r={};h.value&&(r.search=h.value),y.value&&(r.role=y.value),b.value&&(r.status=b.value),C.get("/admin/users",r,{preserveState:!0,replace:!0})},Q=r=>{k.value=r,f.value=""},V=()=>{k.value=null,f.value=""},D=()=>{!f.value||!k.value||(j.value=!0,C.post(`/admin/users/${k.value.id}/ban`,{ban_reason:f.value},{preserveScroll:!0,onFinish:()=>{j.value=!1,V()}}))},I=r=>{confirm("Bạn có chắc chắn muốn mở khóa tài khoản này?")&&C.post(`/admin/users/${r}/unban`,{},{preserveScroll:!0})},S=()=>{H.value=!1,m.value={name:"",email:"",phone:"",password:"",role:"customer"},d.value={}},R=()=>{M.value=!0,d.value={},C.post("/admin/users",m.value,{preserveScroll:!0,onSuccess:()=>{S()},onError:r=>{d.value=r},onFinish:()=>{M.value=!1}})},A=r=>r?new Date(r).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}):"",O=r=>{if(r?.avatar)return r.avatar;const t=r?.name||"User";return`https://ui-avatars.com/api/?name=${encodeURIComponent(t)}&background=000066&color=fff&size=128`},P=(r,t)=>{t?.name&&(r.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(t.name)}&background=000066&color=fff&size=128`)};return(r,t)=>(o(),l($,null,[g(p(Z),{title:"Quản lý Tài khoản"}),g(J,{title:"Quản lý Tài khoản"},{default:_(()=>[e("div",re,[e("div",oe,[t[11]||(t[11]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900"},"Quản lý Tài khoản"),e("p",{class:"text-gray-600 mt-1"},"Quản lý tất cả tài khoản trong hệ thống")],-1)),g(W,{onClick:t[0]||(t[0]=s=>H.value=!0)},{default:_(()=>[g(p(Y),{class:"h-5 w-5 mr-2"}),t[10]||(t[10]=i(" Thêm tài khoản ",-1))]),_:1})]),e("div",le,[e("div",ae,[e("div",ne,[x(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>h.value=s),type:"text",placeholder:"Tìm kiếm theo tên, email, số điện thoại...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",onInput:L},null,544),[[w,h.value]])]),e("div",null,[x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",onChange:N},[...t[12]||(t[12]=[e("option",{value:""},"Tất cả vai trò",-1),e("option",{value:"customer"},"Khách hàng",-1),e("option",{value:"manager"},"Quản lý",-1)])],544),[[z,y.value]])]),e("div",null,[x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>b.value=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",onChange:N},[...t[13]||(t[13]=[e("option",{value:""},"Tất cả trạng thái",-1),e("option",{value:"active"},"Đang hoạt động",-1),e("option",{value:"banned"},"Đã khóa",-1)])],544),[[z,b.value]])])])]),e("div",ie,[e("div",de,[e("table",ue,[t[16]||(t[16]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Người dùng "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Vai trò "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Trạng thái "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Đặt phòng "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ngày tạo "),e("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Thao tác ")])],-1)),e("tbody",me,[(o(!0),l($,null,q(a.users.data,s=>(o(),l("tr",{key:s.id,class:"hover:bg-gray-50"},[e("td",ce,[e("div",pe,[e("div",ge,[e("img",{src:O(s),alt:s.name,class:"h-10 w-10 rounded-full object-cover border-2 border-gray-200",onError:v=>P(v,s)},null,40,xe)]),e("div",fe,[e("div",ve,n(s.name),1),e("div",he,n(s.email),1),s.phone?(o(),l("div",ye,n(s.phone),1)):u("",!0)])])]),e("td",be,[e("span",{class:E(["inline-flex px-2 py-1 text-xs font-semibold rounded-full",s.role==="manager"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"])},n(s.role==="manager"?"Quản lý":"Khách hàng"),3)]),e("td",we,[s.banned_at?(o(),l("span",ke," Đã khóa ")):(o(),l("span",_e," Hoạt động "))]),e("td",Ce,n(s.bookings_count||0),1),e("td",Te,n(A(s.created_at)),1),e("td",je,[e("div",Me,[e("div",Ve,[g(p(U),{href:`/admin/users/${s.id}`,class:"inline-flex items-center justify-center w-8 h-8 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-primary transition-colors",title:"Xem chi tiết"},{default:_(()=>[g(p(ee),{class:"h-5 w-5"})]),_:1},8,["href"]),t[14]||(t[14]=e("div",{class:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 text-xs font-medium text-white bg-gray-900 rounded shadow-lg whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none z-50"},[i(" Xem chi tiết "),e("div",{class:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})],-1))]),s.role!=="manager"&&s.id!==r.$page.props.auth.user.id?(o(),l("div",Se,[s.banned_at?(o(),l("button",{key:1,onClick:v=>I(s.id),class:"inline-flex items-center justify-center w-8 h-8 rounded-lg text-gray-600 hover:bg-green-50 hover:text-green-600 transition-colors",title:"Mở khóa tài khoản"},[g(p(se),{class:"h-5 w-5"})],8,Ue)):(o(),l("button",{key:0,onClick:v=>Q(s),class:"inline-flex items-center justify-center w-8 h-8 rounded-lg text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors",title:"Khóa tài khoản"},[g(p(te),{class:"h-5 w-5"})],8,$e)),e("div",Be,[i(n(s.banned_at?"Mở khóa tài khoản":"Khóa tài khoản")+" ",1),t[15]||(t[15]=e("div",{class:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"},null,-1))])])):u("",!0)])])]))),128))])])]),a.users.links&&a.users.links.length>3?(o(),l("div",He,[e("div",ze,[e("div",Fe,[a.users.links[0].url?(o(),F(p(U),{key:0,href:a.users.links[0].url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:_(()=>[...t[17]||(t[17]=[i(" Trước ",-1)])]),_:1},8,["href"])):u("",!0),a.users.links[a.users.links.length-1].url?(o(),F(p(U),{key:1,href:a.users.links[a.users.links.length-1].url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:_(()=>[...t[18]||(t[18]=[i(" Sau ",-1)])]),_:1},8,["href"])):u("",!0)]),e("div",Ke,[e("div",null,[e("p",Ne,[t[19]||(t[19]=i(" Hiển thị ",-1)),e("span",qe,n(a.users.from),1),t[20]||(t[20]=i(" đến ",-1)),e("span",Ee,n(a.users.to),1),t[21]||(t[21]=i(" trong tổng số ",-1)),e("span",Le,n(a.users.total),1),t[22]||(t[22]=i(" kết quả ",-1))])]),e("div",null,[e("nav",Qe,[(o(!0),l($,null,q(a.users.links,(s,v)=>(o(),l($,{key:v},[s.url?(o(),F(p(U),{key:0,href:s.url,innerHTML:s.label,class:E(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",s.active?"z-10 bg-primary border-primary text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50",v===0?"rounded-l-md":"",v===a.users.links.length-1?"rounded-r-md":""])},null,8,["href","innerHTML","class"])):(o(),l("span",{key:1,innerHTML:s.label,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-300"},null,8,De))],64))),128))])])])])])):u("",!0),a.users.data.length===0?(o(),l("div",Ie,[g(p(G),{class:"mx-auto h-12 w-12 text-gray-400"}),t[23]||(t[23]=e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Không có người dùng",-1)),t[24]||(t[24]=e("p",{class:"mt-1 text-sm text-gray-500"},"Không tìm thấy người dùng nào phù hợp với bộ lọc.",-1))])):u("",!0)]),H.value?(o(),l("div",{key:0,class:"fixed inset-0 z-50 overflow-y-auto",onClick:B(S,["self"])},[e("div",Re,[e("div",{class:"fixed inset-0 bg-black opacity-50",onClick:S}),e("div",Ae,[t[31]||(t[31]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Thêm tài khoản mới",-1)),e("form",{onSubmit:B(R,["prevent"])},[e("div",Oe,[e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Họ tên "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>m.value.name=s),type:"text",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Nhập họ tên",required:""},null,512),[[w,m.value.name]]),d.value.name?(o(),l("p",Pe,n(d.value.name),1)):u("",!0)]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Email "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>m.value.email=s),type:"email",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"example@email.com",required:""},null,512),[[w,m.value.email]]),d.value.email?(o(),l("p",Xe,n(d.value.email),1)):u("",!0)]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Số điện thoại "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>m.value.phone=s),type:"tel",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"0123456789",required:""},null,512),[[w,m.value.phone]]),d.value.phone?(o(),l("p",Ze,n(d.value.phone),1)):u("",!0)]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Mật khẩu "),e("span",{class:"text-red-500"},"*")],-1)),x(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>m.value.password=s),type:"password",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Tối thiểu 6 ký tự",required:""},null,512),[[w,m.value.password]]),d.value.password?(o(),l("p",Ge,n(d.value.password),1)):u("",!0)]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Vai trò "),e("span",{class:"text-red-500"},"*")],-1)),x(e("select",{"onUpdate:modelValue":t[8]||(t[8]=s=>m.value.role=s),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",required:""},[...t[29]||(t[29]=[e("option",{value:"customer"},"Khách hàng",-1),e("option",{value:"manager"},"Quản lý",-1)])],512),[[z,m.value.role]]),d.value.role?(o(),l("p",Je,n(d.value.role),1)):u("",!0)])]),e("div",We,[e("button",{type:"button",onClick:S,class:"px-4 py-2 border-2 border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"}," Hủy "),e("button",{type:"submit",disabled:M.value,class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},n(M.value?"Đang tạo...":"Tạo tài khoản"),9,Ye)])],32)])])])):u("",!0),k.value?(o(),l("div",{key:1,class:"fixed inset-0 z-50 overflow-y-auto",onClick:B(V,["self"])},[e("div",et,[e("div",{class:"fixed inset-0 bg-black opacity-50",onClick:V}),e("div",tt,[t[33]||(t[33]=e("h3",{class:"text-lg font-semibold text-gray-900 mb-4"},"Khóa tài khoản",-1)),e("form",{onSubmit:B(D,["prevent"])},[e("div",st,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[i(" Lý do khóa "),e("span",{class:"text-red-500"},"*")],-1)),x(e("textarea",{"onUpdate:modelValue":t[9]||(t[9]=s=>f.value=s),rows:"4",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"Nhập lý do khóa tài khoản...",required:""},null,512),[[w,f.value]])]),e("div",rt,[e("button",{type:"button",onClick:V,class:"px-4 py-2 border-2 border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"}," Hủy "),e("button",{type:"submit",disabled:!f.value||j.value,class:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},n(j.value?"Đang xử lý...":"Khóa tài khoản"),9,ot)])],32)])])])):u("",!0)])]),_:1})],64))}};export{vt as default};
