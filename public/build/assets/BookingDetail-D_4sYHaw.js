import{c as i,d as t,o as s,A as j,a as g,b as d,h as S,w as y,q as h,f as m,e as r,t as n,n as f,y as u,F as p,i as H,l as v}from"./app-Ce3tobvh.js";import{_ as F}from"./AppLayout-De_nFhHo.js";import{_ as L,a as A}from"./ReviewItem-B4roRxFn.js";import{r as q}from"./ArrowLeftIcon-DlGiXaHZ.js";import{r as z}from"./DocumentTextIcon-UUcijDXL.js";import{r as X}from"./CreditCardIcon-DkhAHsjB.js";import{r as E}from"./PencilIcon-HN5fZDzh.js";import{r as G}from"./PhoneIcon-DVIVdYpT.js";import{r as I}from"./EnvelopeIcon-CSmWFUwf.js";/* empty css            */import"./auth-D-FuMMO3.js";import"./FlashToaster-B9CL1QPN.js";import"./ChevronDownIcon-9prgtg8z.js";import"./UserIcon-CRfiMSUh.js";import"./StarIcon-CTDvIkwX.js";import"./PhotoIcon-Dyo6HhiY.js";import"./BuildingOfficeIcon-DMZfZqAJ.js";function K(o,b){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"})])}function Q(o,b){return s(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m2.25 0H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"})])}const R={class:"booking-detail bg-light min-h-screen py-12"},O={class:"container mx-auto px-4"},U={class:"mb-6"},Z={key:0,class:"text-center py-20"},J={key:1,class:"grid lg:grid-cols-3 gap-8"},W={class:"lg:col-span-2 space-y-6"},Y={class:"card p-6"},tt={class:"flex items-start justify-between mb-6"},et={class:"text-gray-600"},ot={class:"font-mono font-semibold text-primary"},st={class:"grid md:grid-cols-2 gap-6"},nt={class:"space-y-4"},it={class:"text-lg font-semibold text-gray-900"},at={class:"text-sm text-gray-600 mt-1"},rt={class:"text-lg font-semibold text-gray-900"},lt={key:0,class:"text-sm text-gray-600 mt-1"},dt={class:"space-y-4"},gt={class:"text-lg font-semibold text-gray-900"},mt={class:"text-lg font-semibold text-gray-900"},bt={class:"text-lg font-semibold text-primary"},ct={key:0,class:"mt-6 pt-6 border-t"},yt={class:"text-gray-700 bg-gray-50 px-4 py-3 rounded-lg whitespace-pre-wrap"},ht={class:"card p-6"},ut={class:"space-y-4"},xt={class:"flex justify-between items-center py-3 border-b"},kt={class:"font-semibold text-gray-900 text-lg"},ft={key:0,class:"flex justify-between items-center py-3 border-b"},pt={class:"font-semibold text-green-600 text-lg"},vt={class:"flex justify-between items-center pt-4 mt-2 border-t-2 border-gray-400"},wt={class:"text-3xl font-bold text-primary"},$t={class:"grid md:grid-cols-2 gap-6 mt-6 pt-6 border-t"},Tt={key:0},_t={class:"font-semibold text-gray-900"},Ct={key:1},Mt={class:"font-semibold text-gray-900"},Dt={key:2},Nt={class:"font-mono text-sm text-gray-900 break-all"},Vt={class:"card p-6"},Bt={class:"space-y-4"},Pt={class:"flex items-center justify-between p-4 bg-gray-50 rounded-lg"},jt={class:"text-sm text-gray-600 mt-1"},St={key:0,class:"text-green-600"},Ht={key:1,class:"text-yellow-600"},Ft={key:0,class:"text-xs text-gray-500 mt-1"},Lt={class:"flex space-x-2"},At=["href"],qt=["href"],zt={class:"card p-6"},Xt={key:0,class:"space-y-4"},Et={class:"flex items-start justify-between mb-3"},Gt={class:"font-semibold text-gray-900"},It={key:0,class:"text-sm text-gray-500 mt-1"},Kt={class:"grid md:grid-cols-2 gap-4 mb-4"},Qt={class:"font-semibold text-gray-900"},Rt={class:"font-semibold text-gray-900"},Ot={class:"font-semibold text-gray-900"},Ut={class:"font-bold text-primary text-lg"},Zt={class:"flex items-center justify-between pt-3 border-t"},Jt={class:"text-sm text-gray-600"},Wt={key:0},Yt={key:1},te={class:"flex space-x-2"},ee={key:1,class:"text-center py-8 text-gray-500"},oe={key:0,class:"card p-6"},se={key:1,class:"space-y-4"},ne={class:"lg:col-span-1"},ie={class:"card p-6 sticky top-24 space-y-4"},ae={key:1,class:"space-y-3"},re=["href"],le=["href"],de={class:"pt-6 border-t"},ge={key:0,class:"bg-primary-50 rounded-lg p-4"},me={class:"space-y-2 text-sm"},be={class:"font-semibold text-gray-900"},ce={key:0,class:"flex items-center text-gray-700"},ye=["href"],he={key:1,class:"flex items-center text-gray-700"},ue=["href"],xe={key:1,class:"text-sm text-gray-500"},ke={key:2,class:"pt-6 border-t"},fe={class:"rounded-lg overflow-hidden border border-gray-200"},pe=["src"],qe={__name:"BookingDetail",props:{booking:{type:Object,default:null}},setup(o){const b=o,c=a=>!a&&a!==0?"0 ₫":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(a),x=a=>a?new Date(a).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"}):"",k=a=>a?new Date(a).toLocaleString("vi-VN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"",w=(a,e)=>{if(!a||!e)return 0;const l=new Date(a),B=new Date(e),P=Math.abs(B-l);return Math.ceil(P/(1e3*60*60*24))},$=a=>({upcoming:"Sắp tới",active:"Đang ở",past:"Đã ở",pending:"Chờ thanh toán",completed:"Đã kết thúc",cancelled:"Đã hủy"})[a]||a,T=a=>({upcoming:"bg-amber-100 text-amber-800 border border-amber-300",active:"bg-green-100 text-green-700",past:"bg-gray-100 text-gray-600",pending:"bg-yellow-100 text-yellow-700",completed:"bg-gray-100 text-gray-600",cancelled:"bg-red-100 text-red-700"})[a]||"bg-gray-100 text-gray-600",_=a=>({pending:"Chờ thanh toán",paid:"Đã thanh toán",failed:"Thanh toán thất bại",cancelled:"Đã hủy"})[a]||a,C=a=>({pending:"bg-yellow-100 text-yellow-700",paid:"bg-green-100 text-green-700",failed:"bg-red-100 text-red-700",cancelled:"bg-gray-100 text-gray-600"})[a]||"bg-gray-100 text-gray-600",M=a=>({vnpay:"VNPay",bank_transfer:"Chuyển khoản ngân hàng",cash:"Tiền mặt"})[a]||a,D=j(()=>{if(!b.booking?.house?.latitude||!b.booking?.house?.longitude)return"";const a=b.booking.house.latitude,e=b.booking.house.longitude;return`https://www.google.com/maps?q=${a},${e}&hl=vi&z=15&output=embed`}),N=()=>{b.booking?.id&&v.visit(`/payment/${b.booking.id}`)},V=()=>{v.reload({only:["booking"],preserveScroll:!0})};return(a,e)=>(s(),i(p,null,[g(d(S),{title:`Chi tiết đặt phòng #${o.booking?.booking_code||""}`},null,8,["title"]),g(F,null,{default:y(()=>[t("div",R,[t("div",O,[t("div",U,[g(d(h),{href:"/my-rentals",class:"inline-flex items-center text-primary hover:text-primary-dark mb-4"},{default:y(()=>[g(d(q),{class:"w-5 h-5 mr-2"}),e[0]||(e[0]=m(" Quay lại lịch sử thuê phòng ",-1))]),_:1}),e[1]||(e[1]=t("h1",{class:"text-3xl font-bold text-secondary"},"Chi tiết đặt phòng",-1))]),o.booking?(s(),i("div",J,[t("div",W,[t("div",Y,[t("div",tt,[t("div",null,[e[4]||(e[4]=t("h2",{class:"text-2xl font-bold text-secondary mb-2"},"Thông tin đặt phòng",-1)),t("p",et,[e[3]||(e[3]=m("Mã đặt phòng: ",-1)),t("span",ot,n(o.booking.booking_code),1)])]),t("span",{class:f(["badge text-sm",T(o.booking.booking_status||o.booking.status)])},n($(o.booking.booking_status||o.booking.status)),3)]),t("div",st,[t("div",nt,[t("div",null,[e[6]||(e[6]=t("label",{class:"text-sm font-medium text-gray-500 block mb-1"},"Nhà trọ",-1)),t("p",it,n(o.booking.house.name),1),t("p",at,n(o.booking.house.address),1),o.booking.house.id?(s(),u(d(h),{key:0,href:`/houses/${o.booking.house.id}`,class:"text-primary hover:text-primary-dark text-sm mt-2 inline-block"},{default:y(()=>[...e[5]||(e[5]=[m(" Xem chi tiết nhà trọ → ",-1)])]),_:1},8,["href"])):r("",!0)]),t("div",null,[e[7]||(e[7]=t("label",{class:"text-sm font-medium text-gray-500 block mb-1"},"Phòng",-1)),t("p",rt," Phòng "+n(o.booking.room.room_number)+" - Tầng "+n(o.booking.room.floor),1),o.booking.room.area?(s(),i("p",lt," Diện tích: "+n(o.booking.room.area)+" m² ",1)):r("",!0)])]),t("div",dt,[t("div",null,[e[8]||(e[8]=t("label",{class:"text-sm font-medium text-gray-500 block mb-1"},"Ngày nhận phòng",-1)),t("p",gt,n(x(o.booking.start_date)),1)]),t("div",null,[e[9]||(e[9]=t("label",{class:"text-sm font-medium text-gray-500 block mb-1"},"Ngày trả phòng",-1)),t("p",mt,n(x(o.booking.end_date)),1)]),t("div",null,[e[10]||(e[10]=t("label",{class:"text-sm font-medium text-gray-500 block mb-1"},"Số ngày thuê",-1)),t("p",bt,n(w(o.booking.start_date,o.booking.end_date))+" ngày",1)])])]),o.booking.notes?(s(),i("div",ct,[e[11]||(e[11]=t("label",{class:"text-sm font-medium text-gray-500 block mb-2"},"Ghi chú",-1)),t("p",yt,n(o.booking.notes),1)])):r("",!0)]),t("div",ht,[e[19]||(e[19]=t("h2",{class:"text-2xl font-bold text-secondary mb-6"},"Thông tin thanh toán",-1)),t("div",ut,[t("div",xt,[e[12]||(e[12]=t("span",{class:"text-gray-700 font-medium"},"Tổng tiền phòng",-1)),t("span",kt,n(c(o.booking.total_price+o.booking.discount_amount)),1)]),o.booking.discount_amount>0?(s(),i("div",ft,[e[13]||(e[13]=t("span",{class:"text-gray-700 font-medium"},"Giảm giá",-1)),t("span",pt," -"+n(c(o.booking.discount_amount)),1)])):r("",!0),t("div",vt,[e[14]||(e[14]=t("span",{class:"text-xl font-bold text-gray-900"},"Tổng thanh toán",-1)),t("span",wt,n(c(o.booking.total_price)),1)])]),t("div",$t,[t("div",null,[e[15]||(e[15]=t("label",{class:"text-sm font-medium text-gray-500 block mb-2"},"Trạng thái thanh toán",-1)),t("span",{class:f(["inline-block px-3 py-1 text-sm rounded-full",C(o.booking.payment_status)])},n(_(o.booking.payment_status)),3)]),o.booking.payment_method?(s(),i("div",Tt,[e[16]||(e[16]=t("label",{class:"text-sm font-medium text-gray-500 block mb-2"},"Phương thức thanh toán",-1)),t("p",_t,n(M(o.booking.payment_method)),1)])):r("",!0),o.booking.paid_at?(s(),i("div",Ct,[e[17]||(e[17]=t("label",{class:"text-sm font-medium text-gray-500 block mb-2"},"Thời gian thanh toán",-1)),t("p",Mt,n(k(o.booking.paid_at)),1)])):r("",!0),o.booking.vnpay_transaction_id?(s(),i("div",Dt,[e[18]||(e[18]=t("label",{class:"text-sm font-medium text-gray-500 block mb-2"},"Mã giao dịch",-1)),t("p",Nt,n(o.booking.vnpay_transaction_id),1)])):r("",!0)])]),t("div",Vt,[e[22]||(e[22]=t("h2",{class:"text-2xl font-bold text-secondary mb-6"},"Hợp đồng",-1)),t("div",Bt,[t("div",Pt,[t("div",null,[e[20]||(e[20]=t("p",{class:"font-semibold text-gray-900"},"Trạng thái hợp đồng",-1)),t("p",jt,[o.booking.contract_signed?(s(),i("span",St,"Đã ký hợp đồng")):(s(),i("span",Ht,"Chưa ký hợp đồng"))]),o.booking.signed_at?(s(),i("p",Ft," Đã ký vào: "+n(k(o.booking.signed_at)),1)):r("",!0)]),t("div",Lt,[t("a",{href:`/contract/${o.booking.id}/preview`,target:"_blank",class:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition-colors"}," Xem hợp đồng ",8,At),t("a",{href:`/contract/${o.booking.id}`,target:"_blank",class:"px-4 py-2 border-2 border-primary text-primary rounded-lg hover:bg-primary hover:text-white transition-colors"}," Tải PDF ",8,qt),!o.booking.contract_signed&&o.booking.payment_status==="paid"?(s(),u(d(h),{key:0,href:`/contract/${o.booking.id}/sign`,class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"},{default:y(()=>[...e[21]||(e[21]=[m(" Ký hợp đồng ",-1)])]),_:1},8,["href"])):r("",!0)])])])]),t("div",zt,[e[30]||(e[30]=t("h2",{class:"text-2xl font-bold text-secondary mb-6"},"Hóa đơn dịch vụ",-1)),o.booking.invoices&&o.booking.invoices.length>0?(s(),i("div",Xt,[(s(!0),i(p,null,H(o.booking.invoices,l=>(s(),i("div",{key:l.id,class:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow"},[t("div",Et,[t("div",null,[t("p",Gt,n(l.month_year||`Hóa đơn ${l.month}/${l.year}`),1),l.invoice_code?(s(),i("p",It," Mã: "+n(l.invoice_code),1)):r("",!0)]),t("span",{class:f(["badge text-xs",l.status==="paid"?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700"])},n(l.status==="paid"?"Đã thanh toán":"Chưa thanh toán"),3)]),t("div",Kt,[t("div",null,[e[23]||(e[23]=t("p",{class:"text-sm text-gray-600"},"Điện",-1)),t("p",Qt,n(c(l.electricity_amount)),1)]),t("div",null,[e[24]||(e[24]=t("p",{class:"text-sm text-gray-600"},"Nước",-1)),t("p",Rt,n(c(l.water_amount)),1)]),t("div",null,[e[25]||(e[25]=t("p",{class:"text-sm text-gray-600"},"Internet",-1)),t("p",Ot,n(c(l.other_fees)),1)]),t("div",null,[e[26]||(e[26]=t("p",{class:"text-sm text-gray-600"},"Tổng cộng",-1)),t("p",Ut,n(c(l.total)),1)])]),t("div",Zt,[t("div",Jt,[l.due_date?(s(),i("p",Wt,"Hạn thanh toán: "+n(x(l.due_date)),1)):r("",!0),l.paid_at?(s(),i("p",Yt,"Đã thanh toán: "+n(k(l.paid_at)),1)):r("",!0)]),t("div",te,[g(d(h),{href:`/invoices/${l.id}`,class:"px-3 py-1 text-sm border border-gray-300 rounded-lg hover:bg-gray-50"},{default:y(()=>[...e[27]||(e[27]=[m(" Chi tiết ",-1)])]),_:1},8,["href"]),l.status!=="paid"?(s(),u(d(h),{key:0,href:`/payment/invoice/${l.id}`,class:"px-3 py-1 text-sm bg-primary text-white rounded-lg hover:bg-primary-dark"},{default:y(()=>[...e[28]||(e[28]=[m(" Thanh toán ",-1)])]),_:1},8,["href"])):r("",!0)])])]))),128))])):(s(),i("div",ee,[g(d(z),{class:"w-16 h-16 mx-auto mb-2 text-gray-300"}),e[29]||(e[29]=t("p",null,"Chưa có hóa đơn dịch vụ",-1))]))]),o.booking.review||o.booking.can_review?(s(),i("div",oe,[e[31]||(e[31]=t("h2",{class:"text-2xl font-bold text-secondary mb-6"},"Đánh giá",-1)),o.booking.can_review&&o.booking.payment_status==="paid"?(s(),u(L,{key:0,"booking-id":o.booking.id,"house-id":o.booking.house.id,onReviewCreated:V},null,8,["booking-id","house-id"])):r("",!0),o.booking.review?(s(),i("div",se,[g(A,{review:o.booking.review},null,8,["review"])])):r("",!0)])):r("",!0)]),t("div",ne,[t("div",ie,[e[40]||(e[40]=t("h3",{class:"text-lg font-bold text-secondary mb-4"},"Thao tác",-1)),o.booking.payment_status==="pending"?(s(),i("button",{key:0,onClick:N,class:"w-full btn-primary"},[g(d(X),{class:"w-5 h-5 inline mr-2"}),e[32]||(e[32]=m(" Thanh toán ngay ",-1))])):r("",!0),o.booking.payment_status==="paid"?(s(),i("div",ae,[t("a",{href:`/contract/${o.booking.id}/preview`,target:"_blank",class:"block w-full btn-outline text-center"},[g(d(Q),{class:"w-5 h-5 inline mr-2"}),e[33]||(e[33]=m(" Xem hợp đồng ",-1))],8,re),t("a",{href:`/contract/${o.booking.id}`,target:"_blank",class:"block w-full btn-outline text-center"},[g(d(K),{class:"w-5 h-5 inline mr-2"}),e[34]||(e[34]=m(" Tải hợp đồng PDF ",-1))],8,le),o.booking.contract_signed?r("",!0):(s(),u(d(h),{key:0,href:`/contract/${o.booking.id}/sign`,class:"block w-full btn-primary text-center"},{default:y(()=>[g(d(E),{class:"w-5 h-5 inline mr-2"}),e[35]||(e[35]=m(" Ký hợp đồng ",-1))]),_:1},8,["href"]))])):r("",!0),t("div",de,[e[38]||(e[38]=t("h4",{class:"font-semibold text-gray-800 mb-3"},"Liên hệ hỗ trợ",-1)),o.booking.owner?(s(),i("div",ge,[e[36]||(e[36]=t("p",{class:"text-xs font-semibold text-primary-700 mb-2 uppercase"},"Quản lý nhà trọ",-1)),t("div",me,[t("p",be,n(o.booking.owner.name),1),o.booking.owner.phone?(s(),i("p",ce,[g(d(G),{class:"w-4 h-4 mr-2 text-primary"}),t("a",{href:`tel:${o.booking.owner.phone}`,class:"hover:text-primary"},n(o.booking.owner.phone),9,ye)])):r("",!0),o.booking.owner.email?(s(),i("p",he,[g(d(I),{class:"w-4 h-4 mr-2 text-primary"}),t("a",{href:`mailto:${o.booking.owner.email}`,class:"hover:text-primary break-all"},n(o.booking.owner.email),9,ue)])):r("",!0)])])):(s(),i("div",xe,[...e[37]||(e[37]=[t("p",null,"Thông tin quản lý chưa có sẵn",-1)])]))]),o.booking.house.latitude&&o.booking.house.longitude?(s(),i("div",ke,[e[39]||(e[39]=t("h4",{class:"font-semibold text-gray-800 mb-3"},"Vị trí",-1)),t("div",fe,[t("iframe",{src:D.value,width:"100%",height:"200",style:{border:"0"},allowfullscreen:"",loading:"lazy",referrerpolicy:"no-referrer-when-downgrade"},null,8,pe)])])):r("",!0)])])])):(s(),i("div",Z,[...e[2]||(e[2]=[t("div",{class:"inline-block animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent"},null,-1),t("p",{class:"mt-4 text-gray-600"},"Đang tải thông tin...",-1)])]))])])]),_:1})],64))}};export{qe as default};
