import{r as X,x as A,A as E,c as m,a as r,b as a,h as M,w as c,d as t,q as x,f as d,e as g,o as i,g as q,v as U,F as y,i as k,t as u,y as v,n as I,l as T}from"./app-CH4CEp7f.js";import{r as w,_ as P}from"./AdminLayout-BT6D36Nk.js";import{_ as $}from"./Button-BzBTj2yc.js";import{_ as C}from"./SelectSearchable-BiWu3_fh.js";import{u as O}from"./useConfirm-Cg2gVp4z.js";import{r as V}from"./PlusIcon-CH2wYw7X.js";import{r as G}from"./MapPinIcon-A7TLZLbH.js";import{r as N}from"./Squares2X2Icon-DgEIqEaI.js";import{r as R}from"./PencilIcon-DvuSnUno.js";import{r as W}from"./TrashIcon-2e9k4UOa.js";/* empty css            */import"./FlashToaster-Co9bFWRi.js";import"./CalendarIcon-DL8s8YjY.js";import"./PhotoIcon-CGQz7Bxq.js";import"./BuildingOfficeIcon-BvyATTDh.js";import"./ChevronUpDownIcon-B4DqVAmi.js";const J={class:"space-y-6"},K={class:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},Y={class:"bg-white rounded-lg shadow-sm p-4"},Z={class:"flex items-center justify-between mb-4"},tt={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},et={class:"bg-white rounded-lg shadow-sm overflow-hidden"},st={class:"overflow-x-auto"},rt={class:"min-w-full divide-y divide-gray-200"},nt={class:"bg-white divide-y divide-gray-200"},at={class:"px-6 py-4 whitespace-nowrap"},lt={class:"flex items-center"},it={class:"flex-shrink-0 h-16 w-16"},ot=["src","alt"],dt={key:1,class:"h-16 w-16 rounded-lg bg-gray-100 flex items-center justify-center border-2 border-gray-200"},mt={class:"ml-4"},ut={class:"text-sm font-medium text-gray-900"},ct={key:0,class:"text-xs text-gray-500 mt-1"},xt={class:"px-6 py-4"},ht={class:"flex items-center text-sm text-gray-900 max-w-xs"},gt={class:"truncate"},ft={class:"px-6 py-4 whitespace-nowrap"},pt={class:"flex flex-col gap-1 text-sm text-gray-500"},yt={class:"flex items-center"},bt={class:"flex items-center"},vt={class:"px-6 py-4 whitespace-nowrap"},wt={class:"flex flex-col gap-1"},_t={class:"flex items-center text-sm"},kt={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},Tt={class:"flex items-center text-sm"},$t={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Ct={class:"px-6 py-4 whitespace-nowrap"},Vt={class:"text-sm font-semibold text-primary"},Nt={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},jt={class:"px-6 py-4 whitespace-nowrap"},St={class:"flex items-center justify-start gap-2"},Ht={class:"relative group"},Lt={class:"relative group"},Bt={class:"relative group"},Dt=["onClick"],Qt={key:0,class:"text-center py-12"},zt={key:1,class:"bg-white px-4 py-3 border-t border-gray-200 sm:px-6"},Ft={class:"flex items-center justify-between"},Xt={class:"flex-1 flex justify-between sm:hidden"},At={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},Et={class:"text-sm text-gray-700"},Mt={class:"font-medium"},qt={class:"font-medium"},Ut={class:"font-medium"},It={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},Pt=["innerHTML"],oe={__name:"Index",props:{houses:Object,filters:{type:Object,default:()=>({})},wards:{type:Array,default:()=>[]},streets:{type:Array,default:()=>[]}},setup(n){const b=n,h=X(b.filters.search||""),l=A({ward_id:b.filters.ward_id||null,street_id:b.filters.street_id||null});let _=null;const j=()=>{clearTimeout(_),_=setTimeout(()=>{f()},300)},S=()=>{l.ward_id&&(l.street_id=null),f()},H=()=>{l.street_id&&(l.ward_id=null),f()},f=()=>{const o={};h.value&&(o.search=h.value),l.ward_id&&(o.ward_id=l.ward_id),l.street_id&&(o.street_id=l.street_id),T.get("/admin/houses",o,{preserveState:!0,replace:!0})},L=E(()=>!!(h.value||l.ward_id||l.street_id)),B=()=>{h.value="",l.ward_id=null,l.street_id=null,f()},D=o=>o?new Intl.NumberFormat("vi-VN").format(o):"0",Q=o=>o?new Date(o).toLocaleDateString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit"}):"",z=O(),F=async o=>{try{await z.show({title:"Xóa nhà trọ",message:`Bạn có chắc chắn muốn xóa nhà trọ "${o.name}"?

Hành động này sẽ xóa tất cả phòng và đặt phòng liên quan. Hành động này không thể hoàn tác.`,confirmText:"Xóa",cancelText:"Hủy",confirmVariant:"danger"}),T.delete(`/admin/houses/${o.id}`,{preserveScroll:!0,onSuccess:()=>{}})}catch(e){e.message!=="USER_CANCELLED"&&console.error("Error showing confirm dialog:",e)}};return(o,e)=>(i(),m(y,null,[r(a(M),{title:"Quản lý Nhà trọ"}),r(P,{title:"Quản lý Nhà trọ"},{default:c(()=>[t("div",J,[t("div",K,[e[4]||(e[4]=t("div",null,[t("h1",{class:"text-2xl font-bold text-gray-900"},"Quản lý Nhà trọ"),t("p",{class:"text-gray-600 mt-1"},"Quản lý tất cả nhà trọ trong hệ thống")],-1)),r(a(x),{href:"/admin/houses/create"},{default:c(()=>[r($,null,{default:c(()=>[r(a(V),{class:"h-5 w-5 mr-2"}),e[3]||(e[3]=d(" Thêm nhà trọ mới ",-1))]),_:1})]),_:1})]),t("div",Y,[t("div",Z,[e[5]||(e[5]=t("h2",{class:"text-lg font-semibold text-gray-900"},"Bộ lọc",-1)),L.value?(i(),m("button",{key:0,onClick:B,class:"text-sm text-primary hover:text-primary-600 font-medium"}," Xóa bộ lọc ")):g("",!0)]),t("div",tt,[t("div",null,[e[6]||(e[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Tìm kiếm ",-1)),q(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>h.value=s),type:"text",placeholder:"Tìm kiếm theo tên, địa chỉ, quản lý...",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent",onInput:j},null,544),[[U,h.value]])]),t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Phường/Xã ",-1)),r(C,{modelValue:l.ward_id,"onUpdate:modelValue":[e[1]||(e[1]=s=>l.ward_id=s),S],options:n.wards,"option-value":"id","option-label":"name",placeholder:"Chọn phường/xã..."},null,8,["modelValue","options"])]),t("div",null,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Đường ",-1)),r(C,{modelValue:l.street_id,"onUpdate:modelValue":[e[2]||(e[2]=s=>l.street_id=s),H],options:n.streets,"option-value":"id","option-label":s=>s.parent?`${s.name} (${s.parent.name})`:s.name,"filter-by":s=>s.parent?`${s.name} ${s.parent.name}`:s.name,placeholder:"Chọn đường..."},null,8,["modelValue","options","option-label","filter-by"])])])]),t("div",et,[t("div",st,[t("table",rt,[e[14]||(e[14]=t("thead",{class:"bg-gray-50"},[t("tr",null,[t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Nhà trọ "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Địa chỉ "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tầng / Số phòng "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Trạng thái "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Giá/ngày "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ngày tạo "),t("th",{class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Thao tác ")])],-1)),t("tbody",nt,[(i(!0),m(y,null,k(n.houses.data,s=>(i(),m("tr",{key:s.id,class:"hover:bg-gray-50"},[t("td",at,[t("div",lt,[t("div",it,[s.image?(i(),m("img",{key:0,src:s.image,alt:s.name,class:"h-16 w-16 rounded-lg object-cover border-2 border-gray-200"},null,8,ot)):(i(),m("div",dt,[r(a(w),{class:"h-8 w-8 text-gray-400"})]))]),t("div",mt,[t("div",ut,u(s.name),1),s.owner?(i(),m("div",ct," Quản lý: "+u(s.owner.name),1)):g("",!0)])])]),t("td",xt,[t("div",ht,[r(a(G),{class:"h-4 w-4 text-gray-400 mr-2 flex-shrink-0"}),t("span",gt,u(s.address),1)])]),t("td",ft,[t("div",pt,[t("div",yt,[r(a(w),{class:"h-4 w-4 text-gray-400 mr-2"}),t("span",null,u(s.floors)+" tầng",1)]),t("div",bt,[r(a(N),{class:"h-4 w-4 text-gray-400 mr-2"}),t("span",null,u(s.rooms_count||0)+" phòng",1)])])]),t("td",vt,[t("div",wt,[t("div",_t,[t("span",kt,[e[9]||(e[9]=t("span",{class:"w-2 h-2 bg-green-500 rounded-full mr-1.5"},null,-1)),d(" "+u(s.available_rooms_count||0)+" trống ",1)])]),t("div",Tt,[t("span",$t,[e[10]||(e[10]=t("span",{class:"w-2 h-2 bg-blue-500 rounded-full mr-1.5"},null,-1)),d(" "+u(s.occupied_rooms_count||0)+" đã thuê ",1)])])])]),t("td",Ct,[t("span",Vt,u(D(s.price_per_day))+" VNĐ/ngày ",1)]),t("td",Nt,u(Q(s.created_at)),1),t("td",jt,[t("div",St,[t("div",Ht,[r(a(x),{href:`/admin/houses/${s.id}/manage`,class:"inline-flex items-center justify-center w-8 h-8 rounded-lg text-gray-600 hover:bg-primary hover:text-white transition-colors",title:"Quản lý phòng"},{default:c(()=>[r(a(N),{class:"h-5 w-5"})]),_:1},8,["href"]),e[11]||(e[11]=t("div",{class:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 text-xs font-medium text-white bg-gray-900 rounded shadow-lg whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none z-50"},[d(" Quản lý phòng "),t("div",{class:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})],-1))]),t("div",Lt,[r(a(x),{href:`/admin/houses/${s.id}/edit`,class:"inline-flex items-center justify-center w-8 h-8 rounded-lg text-gray-600 hover:bg-gray-100 hover:text-primary transition-colors",title:"Chỉnh sửa"},{default:c(()=>[r(a(R),{class:"h-5 w-5"})]),_:1},8,["href"]),e[12]||(e[12]=t("div",{class:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 text-xs font-medium text-white bg-gray-900 rounded shadow-lg whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none z-50"},[d(" Chỉnh sửa "),t("div",{class:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})],-1))]),t("div",Bt,[t("button",{onClick:p=>F(s),class:"inline-flex items-center justify-center w-8 h-8 rounded-lg text-gray-600 hover:bg-red-50 hover:text-red-600 transition-colors",title:"Xóa nhà trọ"},[r(a(W),{class:"h-5 w-5"})],8,Dt),e[13]||(e[13]=t("div",{class:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 px-2 py-1 text-xs font-medium text-white bg-gray-900 rounded shadow-lg whitespace-nowrap opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 pointer-events-none z-50"},[d(" Xóa nhà trọ "),t("div",{class:"absolute top-full left-1/2 -translate-x-1/2 -mt-1 border-4 border-transparent border-t-gray-900"})],-1))])])])]))),128))])])]),!n.houses.data||n.houses.data.length===0?(i(),m("div",Qt,[r(a(w),{class:"mx-auto h-12 w-12 text-gray-400"}),e[16]||(e[16]=t("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"Chưa có nhà trọ nào",-1)),e[17]||(e[17]=t("p",{class:"mt-1 text-sm text-gray-500 mb-4"},"Bắt đầu bằng cách thêm nhà trọ đầu tiên",-1)),r(a(x),{href:"/admin/houses/create"},{default:c(()=>[r($,null,{default:c(()=>[r(a(V),{class:"h-5 w-5 mr-2"}),e[15]||(e[15]=d(" Thêm nhà trọ mới ",-1))]),_:1})]),_:1})])):g("",!0),n.houses.links&&n.houses.links.length>3?(i(),m("div",zt,[t("div",Ft,[t("div",Xt,[n.houses.links[0].url?(i(),v(a(x),{key:0,href:n.houses.links[0].url,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:c(()=>[...e[18]||(e[18]=[d(" Trước ",-1)])]),_:1},8,["href"])):g("",!0),n.houses.links[n.houses.links.length-1].url?(i(),v(a(x),{key:1,href:n.houses.links[n.houses.links.length-1].url,class:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"},{default:c(()=>[...e[19]||(e[19]=[d(" Sau ",-1)])]),_:1},8,["href"])):g("",!0)]),t("div",At,[t("div",null,[t("p",Et,[e[20]||(e[20]=d(" Hiển thị ",-1)),t("span",Mt,u(n.houses.from),1),e[21]||(e[21]=d(" đến ",-1)),t("span",qt,u(n.houses.to),1),e[22]||(e[22]=d(" trong tổng số ",-1)),t("span",Ut,u(n.houses.total),1),e[23]||(e[23]=d(" kết quả ",-1))])]),t("div",null,[t("nav",It,[(i(!0),m(y,null,k(n.houses.links,(s,p)=>(i(),m(y,{key:p},[s.url?(i(),v(a(x),{key:0,href:s.url,innerHTML:s.label,class:I(["relative inline-flex items-center px-4 py-2 border text-sm font-medium",s.active?"z-10 bg-primary border-primary text-white":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50",p===0?"rounded-l-md":"",p===n.houses.links.length-1?"rounded-r-md":""])},null,8,["href","innerHTML","class"])):(i(),m("span",{key:1,innerHTML:s.label,class:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-300"},null,8,Pt))],64))),128))])])])])])):g("",!0)])])]),_:1})],64))}};export{oe as default};
