import{r as v,c as a,a as i,b as p,h as L,w as M,d as t,q as I,f as d,k as D,e as c,g as h,n as y,v as x,o,t as m,F as P,i as G,s as R,l as z}from"./app-6d472UTg.js";import{u as J}from"./index-DrCpizx3.js";import{_ as Z}from"./AdminLayout-TbILbEPA.js";import{_ as H}from"./SelectSearchable-BzIcAQPw.js";import{r as Q}from"./ChevronLeftIcon-BvqHLeBb.js";import{r as _}from"./ExclamationCircleIcon-DcA7EP1b.js";import{r as X}from"./PhotoIcon-B8t2eVA4.js";import{a as Y}from"./FlashToaster-zRPyk37K.js";/* empty css            */import"./MapPinIcon-7FxdwOJS.js";import"./CalendarIcon-DWvWcjC0.js";import"./BuildingOfficeIcon-SYNwqpRa.js";import"./ChevronUpDownIcon-Dqq3O1AS.js";const ee={class:"space-y-6"},te={class:"flex items-center justify-between"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},se={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},le={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ne={class:"mt-6"},ae={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},oe={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},de={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe={class:"flex items-center gap-2"},me={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},ge={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ce={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},ve=["value"],fe={class:"text-sm text-gray-700"},ye={key:0,class:"mt-1 text-sm text-red-600"},be={class:"space-y-4"},he={class:"space-y-4"},xe={class:"flex flex-col items-center"},_e={key:0,class:"text-sm text-red-600"},ke={key:1,class:"space-y-4"},we={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Ve={class:"relative"},Be=["src","alt","onClick"],$e=["onClick"],Ce={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},Me={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Pe={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Te={class:"text-sm text-red-600"},Fe={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},Ie={class:"text-sm text-green-600"},De={class:"flex justify-end gap-3 pt-4 border-t"},Ge=["disabled"],Je={__name:"Create",props:{streets:Array,errors:Object},setup(N){const S={Wifi:"Wifi",AirConditioning:"Điều hòa",HotWater:"Nóng lạnh",PrivateKitchen:"Bếp riêng",SharedKitchen:"Bếp chung",SharedBathroom:"Vệ sinh chung",PrivateBathroom:"Vệ sinh khép kín",Bed:"Giường",Wardrobe:"Tủ",Refrigerator:"Tủ lạnh",Balcony:"Ban công",SharedWashingMachine:"Máy giặt chung",PrivateWashingMachine:"Máy giặt riêng",SharedDryer:"Máy sấy quần áo chung",PrivateDryer:"Máy sấy quần áo riêng"},s=v({name:"",street_detail:"",street_id:"",description:"",amenities:[],price_per_day:"",latitude:"",longitude:""}),B=v(null),T=v(null),k=v([]),w=v([]),g=v([]),$=v(!1),f=v(""),C=v(""),n=v({}),E=r=>r?new Intl.NumberFormat("vi-VN").format(r):"0",U=r=>!r||r===0?"":E(r)+" đ",{isOverDropZone:j}=J(T,{onDrop:r=>{r&&r.length>0&&F(Array.from(r))}}),F=r=>{if(f.value="",w.value.length+r.length>10){f.value="Tối đa 10 ảnh";return}r.forEach(e=>{if(e.size>5*1024*1024){f.value=`Ảnh ${e.name} vượt quá 5MB`;return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/webp"].includes(e.type)){f.value=`File ${e.name} không phải là ảnh hợp lệ (JPEG, PNG, JPG, GIF, WEBP)`;return}w.value.push(e);const u=new FileReader;u.onload=V=>{k.value.push(V.target.result)},u.readAsDataURL(e)})},W=r=>{const e=Array.from(r.target.files);F(e),B.value&&(B.value.value="")},q=r=>{w.value.splice(r,1),k.value.splice(r,1);const e=g.value.indexOf(r);e>-1&&g.value.splice(e,1),g.value=g.value.map(l=>l>r?l-1:l)},O=r=>{const e=g.value.indexOf(r);e>-1?g.value.splice(e,1):g.value.push(r)},b=r=>{n.value[r]&&delete n.value[r]},A=()=>{const r={};return s.value.name?.trim()||(r.name="Vui lòng nhập tên nhà trọ"),s.value.street_detail?.trim()||(r.street_detail="Vui lòng nhập địa chỉ cụ thể"),s.value.street_id||(r.street_id="Vui lòng chọn đường"),(!s.value.price_per_day||s.value.price_per_day<=0)&&(r.price_per_day="Vui lòng nhập giá thuê hợp lệ"),s.value.latitude&&(s.value.latitude<-90||s.value.latitude>90)&&(r.latitude="Vĩ độ phải trong khoảng -90 đến 90"),s.value.longitude&&(s.value.longitude<-180||s.value.longitude>180)&&(r.longitude="Kinh độ phải trong khoảng -180 đến 180"),n.value=r,Object.keys(r).length===0},K=()=>{if(f.value="",C.value="",!A()){f.value="Vui lòng kiểm tra lại các trường bắt buộc";return}$.value=!0;const r=new FormData;r.append("name",s.value.name),r.append("street_detail",s.value.street_detail),r.append("street_id",s.value.street_id),s.value.description&&r.append("description",s.value.description),r.append("price_per_day",s.value.price_per_day),s.value.latitude&&r.append("latitude",s.value.latitude),s.value.longitude&&r.append("longitude",s.value.longitude),s.value.amenities.forEach(e=>{r.append("amenities[]",e)}),w.value.forEach(e=>{r.append("images[]",e)}),g.value.forEach(e=>{r.append("featured_image_indices[]",e)}),z.post("/admin/houses",r,{preserveScroll:!0,onSuccess:()=>{C.value="Đã thêm nhà trọ thành công!",s.value={name:"",street_detail:"",street_id:"",description:"",amenities:[],price_per_day:"",latitude:"",longitude:""},w.value=[],k.value=[],g.value=[]},onError:e=>{n.value=e,e.message&&(f.value=e.message)},onFinish:()=>{$.value=!1}})};return(r,e)=>(o(),a(P,null,[i(p(L),{title:"Thêm nhà trọ mới"}),i(Z,{title:"Thêm nhà trọ mới"},{default:M(()=>[t("div",ee,[t("div",te,[t("div",null,[i(p(I),{href:"/admin/houses",class:"text-primary hover:text-primary-600 mb-2 inline-flex items-center text-sm"},{default:M(()=>[i(p(Q),{class:"h-4 w-4 mr-1"}),e[16]||(e[16]=d(" Quay lại danh sách ",-1))]),_:1}),e[17]||(e[17]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Thêm nhà trọ mới",-1))])]),t("form",{onSubmit:D(K,["prevent"]),class:"bg-white rounded-lg shadow-sm p-6 space-y-6"},[t("div",null,[e[22]||(e[22]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Thông tin cơ bản",-1)),t("div",re,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Tên nhà trọ "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.name=l),type:"text",required:"",class:y(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.name?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Nhập tên nhà trọ",onBlur:e[1]||(e[1]=l=>b("name"))},null,34),[[x,s.value.name]]),n.value.name?(o(),a("p",se,[i(p(_),{class:"h-4 w-4"}),d(" "+m(n.value.name),1)])):c("",!0)]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Địa chỉ cụ thể "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.street_detail=l),type:"text",required:"",class:y(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.street_detail?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Số nhà, ngõ ngách...",onBlur:e[3]||(e[3]=l=>b("street_detail"))},null,34),[[x,s.value.street_detail]]),n.value.street_detail?(o(),a("p",le,[i(p(_),{class:"h-4 w-4"}),d(" "+m(n.value.street_detail),1)])):c("",!0)]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Đường "),t("span",{class:"text-red-500"},"*")],-1)),i(H,{modelValue:s.value.street_id,"onUpdate:modelValue":[e[4]||(e[4]=l=>s.value.street_id=l),e[5]||(e[5]=l=>b("street_id"))],options:N.streets,"option-value":"id","option-label":l=>l.parent?`${l.name} (${l.parent.name})`:l.name,"filter-by":l=>l.parent?`${l.name} ${l.parent.name}`:l.name,placeholder:"Tìm kiếm và chọn đường...",error:n.value.street_id},null,8,["modelValue","options","option-label","filter-by","error"])])]),t("div",ne,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mô tả",-1)),h(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=l=>s.value.description=l),rows:"4",class:y(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.description?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Nhập mô tả về nhà trọ...",onBlur:e[7]||(e[7]=l=>b("description"))},null,34),[[x,s.value.description]]),n.value.description?(o(),a("p",ae,[i(p(_),{class:"h-4 w-4"}),d(" "+m(n.value.description),1)])):c("",!0)])]),t("div",null,[e[25]||(e[25]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Vị trí",-1)),t("div",oe,[t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Vĩ độ",-1)),h(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>s.value.latitude=l),type:"number",step:"any",class:y(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.latitude?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"21.0285",onBlur:e[9]||(e[9]=l=>b("latitude"))},null,34),[[x,s.value.latitude]]),n.value.latitude?(o(),a("p",ie,[i(p(_),{class:"h-4 w-4"}),d(" "+m(n.value.latitude),1)])):c("",!0)]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Kinh độ",-1)),h(t("input",{"onUpdate:modelValue":e[10]||(e[10]=l=>s.value.longitude=l),type:"number",step:"any",class:y(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.longitude?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"105.8542",onBlur:e[11]||(e[11]=l=>b("longitude"))},null,34),[[x,s.value.longitude]]),n.value.longitude?(o(),a("p",de,[i(p(_),{class:"h-4 w-4"}),d(" "+m(n.value.longitude),1)])):c("",!0)])])]),t("div",null,[e[27]||(e[27]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Giá và thông tin",-1)),t("div",ue,[t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Giá thuê/ngày (VNĐ) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",pe,[h(t("input",{"onUpdate:modelValue":e[12]||(e[12]=l=>s.value.price_per_day=l),type:"number",step:"1000",min:"0",required:"",class:y(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",n.value.price_per_day?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"500000",onBlur:e[13]||(e[13]=l=>b("price_per_day"))},null,34),[[x,s.value.price_per_day,void 0,{number:!0}]]),t("span",me,m(U(s.value.price_per_day)),1)]),n.value.price_per_day?(o(),a("p",ge,[i(p(_),{class:"h-4 w-4"}),d(" "+m(n.value.price_per_day),1)])):c("",!0)])])]),t("div",null,[e[28]||(e[28]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Tiện nghi",-1)),t("div",ce,[(o(),a(P,null,G(S,(l,u)=>t("label",{key:u,class:"flex items-center space-x-2 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50"},[h(t("input",{"onUpdate:modelValue":e[14]||(e[14]=V=>s.value.amenities=V),type:"checkbox",value:u,class:"rounded border-gray-300 text-primary focus:ring-primary"},null,8,ve),[[R,s.value.amenities]]),t("span",fe,m(l),1)])),64))]),n.value.amenities?(o(),a("p",ye,m(n.value.amenities),1)):c("",!0)]),t("div",null,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Hình ảnh",-1)),t("div",be,[t("div",{ref_key:"dropZoneRef",ref:T,class:y(["border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",p(j)?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400"]),onClick:e[15]||(e[15]=l=>B.value?.click())},[t("input",{ref_key:"fileInput",ref:B,type:"file",multiple:"",accept:"image/*",onChange:W,class:"hidden"},null,544),t("div",he,[t("div",xe,[i(p(X),{class:"h-12 w-12 text-gray-400 mb-2"}),e[29]||(e[29]=t("p",{class:"text-sm font-medium text-gray-700"},[d(" Kéo thả ảnh vào đây hoặc "),t("span",{class:"text-primary hover:text-primary-600 font-medium underline"}," chọn từ máy tính ")],-1)),e[30]||(e[30]=t("p",{class:"mt-1 text-xs text-gray-500"}," Tối đa 10 ảnh, mỗi ảnh tối đa 5MB ",-1)),e[31]||(e[31]=t("p",{class:"mt-1 text-xs text-gray-500"}," Định dạng: JPEG, PNG, JPG, GIF, WEBP ",-1))])])],2),n.value.images?(o(),a("p",_e,m(n.value.images),1)):c("",!0),k.value.length>0?(o(),a("div",ke,[e[34]||(e[34]=t("p",{class:"text-sm text-gray-600"},[t("span",{class:"font-medium"},"Lưu ý:"),d(" Chọn các ảnh sẽ hiển thị trong trang chi tiết nhà trọ ")],-1)),t("div",we,[(o(!0),a(P,null,G(k.value,(l,u)=>(o(),a("div",{key:u,class:"relative group"},[t("div",Ve,[t("img",{src:l,alt:`Preview ${u+1}`,class:y(["w-full h-32 object-cover rounded-lg border-2 transition-all cursor-pointer",g.value.includes(u)?"border-primary ring-2 ring-primary ring-offset-2":"border-gray-200 hover:border-gray-300"]),onClick:V=>O(u)},null,10,Be),t("button",{type:"button",onClick:D(V=>q(u),["stop"]),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10"},[i(p(Y),{class:"h-4 w-4"})],8,$e),t("div",{class:y(["absolute top-2 left-2 rounded-full p-1 shadow-lg transition-all duration-200",g.value.includes(u)?"bg-primary text-white ring-2 ring-primary ring-offset-2":"bg-white text-gray-400 hover:bg-gray-50"])},[g.value.includes(u)?(o(),a("svg",Ce,[...e[32]||(e[32]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):(o(),a("svg",Me,[...e[33]||(e[33]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])]))],2)])]))),128))])])):c("",!0)])]),f.value?(o(),a("div",Pe,[t("p",Te,m(f.value),1)])):c("",!0),C.value?(o(),a("div",Fe,[t("p",Ie,m(C.value),1)])):c("",!0),t("div",De,[i(p(I),{href:"/admin/houses",class:"px-6 py-2 border-2 border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"},{default:M(()=>[...e[36]||(e[36]=[d(" Hủy ",-1)])]),_:1}),t("button",{type:"submit",disabled:$.value,class:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},m($.value?"Đang lưu...":"Thêm nhà trọ"),9,Ge)])],32)])]),_:1})],64))}};export{Je as default};
