import{r as f,c as o,a as i,b as u,h as L,w as C,d as t,q as S,f as d,k as I,e as c,g as h,n as v,v as x,o as a,t as p,F as M,i as D,s as R,l as z}from"./app-CV3hN5xw.js";import{u as J}from"./index-iD787QDN.js";import{_ as Z}from"./AdminLayout-CDrS6VVX.js";import{_ as H}from"./SelectSearchable-e4QPBkxb.js";import{r as Q}from"./ChevronLeftIcon-CBo3BTaW.js";import{r as _}from"./ExclamationCircleIcon-CDU4dC28.js";import{r as X}from"./PhotoIcon-BCHJDgw1.js";import{a as Y}from"./FlashToaster-_iqtzozx.js";/* empty css            */import"./MapPinIcon-WctZgngs.js";import"./CalendarIcon-Bm0npUtJ.js";import"./BuildingOfficeIcon-DhfgkQfF.js";import"./ChevronUpDownIcon-BpJK3Som.js";const ee={class:"space-y-6"},te={class:"flex items-center justify-between"},re={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},le={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ne={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},se={class:"mt-6"},oe={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ie={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},de={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ue={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},pe={class:"flex items-center gap-2"},me={class:"text-xs text-gray-500 font-medium whitespace-nowrap"},ce={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ge={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ve={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},fe={key:0,class:"mt-1 text-sm text-red-600 flex items-center gap-1"},ye={class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"},be=["value"],he={class:"text-sm text-gray-700"},xe={key:0,class:"mt-1 text-sm text-red-600"},_e={class:"space-y-4"},ke={class:"space-y-4"},we={class:"flex flex-col items-center"},Ve={key:0,class:"text-sm text-red-600"},$e={key:1,class:"space-y-4"},Be={class:"grid grid-cols-2 md:grid-cols-4 gap-4"},Te={class:"relative"},Ce=["src","alt","onClick"],Me=["onClick"],Pe={key:0,class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},Fe={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Se={key:0,class:"p-4 bg-red-50 border border-red-200 rounded-lg"},Ie={class:"text-sm text-red-600"},De={key:1,class:"p-4 bg-green-50 border border-green-200 rounded-lg"},Ee={class:"text-sm text-green-600"},Ge={class:"flex justify-end gap-3 pt-4 border-t"},Ne=["disabled"],Qe={__name:"Create",props:{streets:Array,errors:Object},setup(E){const G={Wifi:"Wifi",AirConditioning:"Điều hòa",HotWater:"Nóng lạnh",PrivateKitchen:"Bếp riêng",SharedKitchen:"Bếp chung",SharedBathroom:"Vệ sinh chung",PrivateBathroom:"Vệ sinh khép kín",Bed:"Giường",Wardrobe:"Tủ",Refrigerator:"Tủ lạnh",Balcony:"Ban công",SharedWashingMachine:"Máy giặt chung",PrivateWashingMachine:"Máy giặt riêng",SharedDryer:"Máy sấy quần áo chung",PrivateDryer:"Máy sấy quần áo riêng"},r=f({name:"",street_detail:"",street_id:"",description:"",amenities:[],price_per_day:"",latitude:"",longitude:"",contact_phone:"",contact_email:""}),$=f(null),P=f(null),k=f([]),w=f([]),g=f([]),B=f(!1),y=f(""),T=f(""),s=f({}),N=l=>l?new Intl.NumberFormat("vi-VN").format(l):"0",U=l=>!l||l===0?"":N(l)+" đ",{isOverDropZone:j}=J(P,{onDrop:l=>{l&&l.length>0&&F(Array.from(l))}}),F=l=>{if(y.value="",w.value.length+l.length>10){y.value="Tối đa 10 ảnh";return}l.forEach(e=>{if(e.size>5*1024*1024){y.value=`Ảnh ${e.name} vượt quá 5MB`;return}if(!["image/jpeg","image/png","image/jpg","image/gif","image/webp"].includes(e.type)){y.value=`File ${e.name} không phải là ảnh hợp lệ (JPEG, PNG, JPG, GIF, WEBP)`;return}w.value.push(e);const m=new FileReader;m.onload=V=>{k.value.push(V.target.result)},m.readAsDataURL(e)})},W=l=>{const e=Array.from(l.target.files);F(e),$.value&&($.value.value="")},q=l=>{w.value.splice(l,1),k.value.splice(l,1);const e=g.value.indexOf(l);e>-1&&g.value.splice(e,1),g.value=g.value.map(n=>n>l?n-1:n)},O=l=>{const e=g.value.indexOf(l);e>-1?g.value.splice(e,1):g.value.push(l)},b=l=>{s.value[l]&&delete s.value[l]},A=()=>{const l={};return r.value.name?.trim()||(l.name="Vui lòng nhập tên nhà trọ"),r.value.street_detail?.trim()||(l.street_detail="Vui lòng nhập địa chỉ cụ thể"),r.value.street_id||(l.street_id="Vui lòng chọn đường"),(!r.value.price_per_day||r.value.price_per_day<=0)&&(l.price_per_day="Vui lòng nhập giá thuê hợp lệ"),r.value.latitude&&(r.value.latitude<-90||r.value.latitude>90)&&(l.latitude="Vĩ độ phải trong khoảng -90 đến 90"),r.value.longitude&&(r.value.longitude<-180||r.value.longitude>180)&&(l.longitude="Kinh độ phải trong khoảng -180 đến 180"),r.value.contact_phone&&!/^(0|\+84)[1-9][0-9]{8,9}$/.test(r.value.contact_phone.replace(/\s+/g,""))&&(l.contact_phone="Số điện thoại không hợp lệ"),r.value.contact_email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.value.contact_email)&&(l.contact_email="Email không hợp lệ"),s.value=l,Object.keys(l).length===0},K=()=>{if(y.value="",T.value="",!A()){y.value="Vui lòng kiểm tra lại các trường bắt buộc";return}B.value=!0;const l=new FormData;l.append("name",r.value.name),l.append("street_detail",r.value.street_detail),l.append("street_id",r.value.street_id),r.value.description&&l.append("description",r.value.description),l.append("price_per_day",r.value.price_per_day),r.value.latitude&&l.append("latitude",r.value.latitude),r.value.longitude&&l.append("longitude",r.value.longitude),r.value.contact_phone&&l.append("contact_phone",r.value.contact_phone),r.value.contact_email&&l.append("contact_email",r.value.contact_email),r.value.amenities.forEach(e=>{l.append("amenities[]",e)}),w.value.forEach(e=>{l.append("images[]",e)}),g.value.forEach(e=>{l.append("featured_image_indices[]",e)}),z.post("/admin/houses",l,{preserveScroll:!0,onSuccess:()=>{T.value="Đã thêm nhà trọ thành công!",r.value={name:"",street_detail:"",street_id:"",description:"",amenities:[],price_per_day:"",latitude:"",longitude:"",contact_phone:"",contact_email:""},w.value=[],k.value=[],g.value=[]},onError:e=>{s.value=e,e.message&&(y.value=e.message)},onFinish:()=>{B.value=!1}})};return(l,e)=>(a(),o(M,null,[i(u(L),{title:"Thêm nhà trọ mới"}),i(Z,{title:"Thêm nhà trọ mới"},{default:C(()=>[t("div",ee,[t("div",te,[t("div",null,[i(u(S),{href:"/admin/houses",class:"text-primary hover:text-primary-600 mb-2 inline-flex items-center text-sm"},{default:C(()=>[i(u(Q),{class:"h-4 w-4 mr-1"}),e[20]||(e[20]=d(" Quay lại danh sách ",-1))]),_:1}),e[21]||(e[21]=t("h1",{class:"text-2xl font-bold text-gray-900"},"Thêm nhà trọ mới",-1))])]),t("form",{onSubmit:I(K,["prevent"]),class:"bg-white rounded-lg shadow-sm p-6 space-y-6"},[t("div",null,[e[26]||(e[26]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Thông tin cơ bản",-1)),t("div",re,[t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Tên nhà trọ "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>r.value.name=n),type:"text",required:"",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.name?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Nhập tên nhà trọ",onBlur:e[1]||(e[1]=n=>b("name"))},null,34),[[x,r.value.name]]),s.value.name?(a(),o("p",le,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.name),1)])):c("",!0)]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Địa chỉ cụ thể "),t("span",{class:"text-red-500"},"*")],-1)),h(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>r.value.street_detail=n),type:"text",required:"",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.street_detail?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Số nhà, ngõ ngách...",onBlur:e[3]||(e[3]=n=>b("street_detail"))},null,34),[[x,r.value.street_detail]]),s.value.street_detail?(a(),o("p",ne,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.street_detail),1)])):c("",!0)]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Đường "),t("span",{class:"text-red-500"},"*")],-1)),i(H,{modelValue:r.value.street_id,"onUpdate:modelValue":[e[4]||(e[4]=n=>r.value.street_id=n),e[5]||(e[5]=n=>b("street_id"))],options:E.streets,"option-value":"id","option-label":n=>n.parent?`${n.name} (${n.parent.name})`:n.name,"filter-by":n=>n.parent?`${n.name} ${n.parent.name}`:n.name,placeholder:"Tìm kiếm và chọn đường...",error:s.value.street_id},null,8,["modelValue","options","option-label","filter-by","error"])])]),t("div",se,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Mô tả",-1)),h(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=n=>r.value.description=n),rows:"4",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.description?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"Nhập mô tả về nhà trọ...",onBlur:e[7]||(e[7]=n=>b("description"))},null,34),[[x,r.value.description]]),s.value.description?(a(),o("p",oe,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.description),1)])):c("",!0)])]),t("div",null,[e[29]||(e[29]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Vị trí",-1)),t("div",ae,[t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Vĩ độ",-1)),h(t("input",{"onUpdate:modelValue":e[8]||(e[8]=n=>r.value.latitude=n),type:"number",step:"any",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.latitude?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"21.0285",onBlur:e[9]||(e[9]=n=>b("latitude"))},null,34),[[x,r.value.latitude]]),s.value.latitude?(a(),o("p",ie,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.latitude),1)])):c("",!0)]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Kinh độ",-1)),h(t("input",{"onUpdate:modelValue":e[10]||(e[10]=n=>r.value.longitude=n),type:"number",step:"any",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.longitude?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"105.8542",onBlur:e[11]||(e[11]=n=>b("longitude"))},null,34),[[x,r.value.longitude]]),s.value.longitude?(a(),o("p",de,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.longitude),1)])):c("",!0)])])]),t("div",null,[e[31]||(e[31]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Giá và thông tin",-1)),t("div",ue,[t("div",null,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},[d(" Giá thuê/ngày (VNĐ) "),t("span",{class:"text-red-500"},"*")],-1)),t("div",pe,[h(t("input",{"onUpdate:modelValue":e[12]||(e[12]=n=>r.value.price_per_day=n),type:"number",step:"1000",min:"0",required:"",class:v(["flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.price_per_day?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"500000",onBlur:e[13]||(e[13]=n=>b("price_per_day"))},null,34),[[x,r.value.price_per_day,void 0,{number:!0}]]),t("span",me,p(U(r.value.price_per_day)),1)]),s.value.price_per_day?(a(),o("p",ce,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.price_per_day),1)])):c("",!0)])])]),t("div",null,[e[34]||(e[34]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Thông tin liên hệ",-1)),t("div",ge,[t("div",null,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Số điện thoại",-1)),h(t("input",{"onUpdate:modelValue":e[14]||(e[14]=n=>r.value.contact_phone=n),type:"tel",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.contact_phone?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"0123456789",onBlur:e[15]||(e[15]=n=>b("contact_phone"))},null,34),[[x,r.value.contact_phone]]),s.value.contact_phone?(a(),o("p",ve,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.contact_phone),1)])):c("",!0)]),t("div",null,[e[33]||(e[33]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Email",-1)),h(t("input",{"onUpdate:modelValue":e[16]||(e[16]=n=>r.value.contact_email=n),type:"email",class:v(["w-full px-4 py-2 border rounded-lg focus:ring-2 focus:outline-none transition-colors",s.value.contact_email?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-primary focus:border-transparent"]),placeholder:"contact@example.com",onBlur:e[17]||(e[17]=n=>b("contact_email"))},null,34),[[x,r.value.contact_email]]),s.value.contact_email?(a(),o("p",fe,[i(u(_),{class:"h-4 w-4"}),d(" "+p(s.value.contact_email),1)])):c("",!0)])])]),t("div",null,[e[35]||(e[35]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Tiện nghi",-1)),t("div",ye,[(a(),o(M,null,D(G,(n,m)=>t("label",{key:m,class:"flex items-center space-x-2 cursor-pointer p-3 border border-gray-200 rounded-lg hover:bg-gray-50"},[h(t("input",{"onUpdate:modelValue":e[18]||(e[18]=V=>r.value.amenities=V),type:"checkbox",value:m,class:"rounded border-gray-300 text-primary focus:ring-primary"},null,8,be),[[R,r.value.amenities]]),t("span",he,p(n),1)])),64))]),s.value.amenities?(a(),o("p",xe,p(s.value.amenities),1)):c("",!0)]),t("div",null,[e[42]||(e[42]=t("h2",{class:"text-lg font-semibold text-gray-900 mb-4"},"Hình ảnh",-1)),t("div",_e,[t("div",{ref_key:"dropZoneRef",ref:P,class:v(["border-2 border-dashed rounded-lg p-8 text-center transition-colors cursor-pointer",u(j)?"border-primary bg-primary/5":"border-gray-300 hover:border-gray-400"]),onClick:e[19]||(e[19]=n=>$.value?.click())},[t("input",{ref_key:"fileInput",ref:$,type:"file",multiple:"",accept:"image/*",onChange:W,class:"hidden"},null,544),t("div",ke,[t("div",we,[i(u(X),{class:"h-12 w-12 text-gray-400 mb-2"}),e[36]||(e[36]=t("p",{class:"text-sm font-medium text-gray-700"},[d(" Kéo thả ảnh vào đây hoặc "),t("span",{class:"text-primary hover:text-primary-600 font-medium underline"}," chọn từ máy tính ")],-1)),e[37]||(e[37]=t("p",{class:"mt-1 text-xs text-gray-500"}," Tối đa 10 ảnh, mỗi ảnh tối đa 5MB ",-1)),e[38]||(e[38]=t("p",{class:"mt-1 text-xs text-gray-500"}," Định dạng: JPEG, PNG, JPG, GIF, WEBP ",-1))])])],2),s.value.images?(a(),o("p",Ve,p(s.value.images),1)):c("",!0),k.value.length>0?(a(),o("div",$e,[e[41]||(e[41]=t("p",{class:"text-sm text-gray-600"},[t("span",{class:"font-medium"},"Lưu ý:"),d(" Chọn các ảnh sẽ hiển thị trong trang chi tiết nhà trọ ")],-1)),t("div",Be,[(a(!0),o(M,null,D(k.value,(n,m)=>(a(),o("div",{key:m,class:"relative group"},[t("div",Te,[t("img",{src:n,alt:`Preview ${m+1}`,class:v(["w-full h-32 object-cover rounded-lg border-2 transition-all cursor-pointer",g.value.includes(m)?"border-primary ring-2 ring-primary ring-offset-2":"border-gray-200 hover:border-gray-300"]),onClick:V=>O(m)},null,10,Ce),t("button",{type:"button",onClick:I(V=>q(m),["stop"]),class:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity z-10"},[i(u(Y),{class:"h-4 w-4"})],8,Me),t("div",{class:v(["absolute top-2 left-2 rounded-full p-1 shadow-lg transition-all duration-200",g.value.includes(m)?"bg-primary text-white ring-2 ring-primary ring-offset-2":"bg-white text-gray-400 hover:bg-gray-50"])},[g.value.includes(m)?(a(),o("svg",Pe,[...e[39]||(e[39]=[t("path",{"fill-rule":"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z","clip-rule":"evenodd"},null,-1)])])):(a(),o("svg",Fe,[...e[40]||(e[40]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)])]))],2)])]))),128))])])):c("",!0)])]),y.value?(a(),o("div",Se,[t("p",Ie,p(y.value),1)])):c("",!0),T.value?(a(),o("div",De,[t("p",Ee,p(T.value),1)])):c("",!0),t("div",Ge,[i(u(S),{href:"/admin/houses",class:"px-6 py-2 border-2 border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors"},{default:C(()=>[...e[43]||(e[43]=[d(" Hủy ",-1)])]),_:1}),t("button",{type:"submit",disabled:B.value,class:"px-6 py-2 bg-primary text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors"},p(B.value?"Đang lưu...":"Thêm nhà trọ"),9,Ne)])],32)])]),_:1})],64))}};export{Qe as default};
