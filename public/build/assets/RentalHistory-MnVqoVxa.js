import{c as o,d as t,o as r,A as u,z as D,u as P,a as l,b as i,h as I,w as h,e as d,t as a,q as _,f as v,F as y,i as w,n as x,l as L}from"./app-osEW8NDv.js";import{_ as A}from"./AppLayout-Dj-bG975.js";import{r as k}from"./CalendarIcon-CPDdy-lK.js";import{r as F}from"./DocumentTextIcon-DKEYpgiE.js";/* empty css            */import"./auth-zbzIRb7v.js";import"./FlashToaster-AYY5HN4c.js";import"./ChevronDownIcon-O0oeKHZX.js";import"./UserIcon-bG0JrhPg.js";import"./PhoneIcon-cXC50k2k.js";import"./EnvelopeIcon-rm14h0Hq.js";function Z(g,c){return r(),o("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"})])}const U={class:"rental-history bg-light min-h-screen py-12"},z={class:"container mx-auto px-4"},R={key:0,class:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg"},Y={class:"text-green-800"},q={key:1,class:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg"},E={class:"text-red-800"},Q={key:2,class:"mb-6 p-4 bg-blue-50 border border-blue-200 rounded-lg"},X={class:"text-blue-800"},G={class:"grid lg:grid-cols-3 gap-8"},J={class:"lg:col-span-2 space-y-6"},K={key:0,class:"card p-12 text-center"},O={class:"flex items-start justify-between mb-4"},W={class:"flex-1"},tt={class:"flex items-center gap-3 mb-1"},st={class:"text-xl font-bold text-secondary"},et={key:0,class:"px-2 py-1 bg-primary-100 text-primary-700 rounded text-xs font-mono font-semibold"},nt={class:"text-gray-600"},at={class:"grid md:grid-cols-2 gap-4 mb-4"},ot={class:"flex items-center space-x-2 text-gray-600"},rt={class:"font-medium"},lt={class:"flex items-center space-x-2 text-gray-600"},it={class:"font-medium"},dt={class:"mb-4"},ct={class:"flex items-center justify-between pt-4 border-t"},pt={class:"text-2xl font-bold text-primary"},gt={class:"flex space-x-2"},ut=["onClick"],mt=["href"],ht={class:"lg:col-span-1"},yt={class:"card p-6 sticky top-24 space-y-6"},xt={key:0,class:"text-center py-8"},ft={key:1,class:"space-y-4"},bt={class:"flex items-center justify-between mb-3"},_t={class:"text-sm font-medium text-gray-700"},vt={class:"space-y-2 text-sm mb-3"},wt={class:"flex justify-between"},kt={class:"font-medium"},Ct={class:"flex justify-between"},Mt={class:"font-medium"},$t={class:"flex justify-between"},Tt={class:"font-medium"},Vt={class:"pt-3 border-t flex items-center justify-between"},Ht={class:"text-lg font-bold text-primary"},St={class:"mt-6 pt-6 border-t"},jt={class:"space-y-3"},Bt={class:"flex items-center justify-between p-3 bg-primary-50 rounded-lg"},Nt={class:"font-bold text-primary"},Dt={class:"flex items-center justify-between p-3 bg-primary-50 rounded-lg"},Pt={class:"font-bold text-primary"},It={class:"flex items-center justify-between p-3 bg-secondary-50 rounded-lg"},Lt={class:"font-bold text-secondary"},Gt={__name:"RentalHistory",props:{bookings:{type:Array,default:()=>[]},invoices:{type:Array,default:()=>[]}},setup(g){const c=g,C=u(()=>c.bookings.filter(n=>n.status==="active")),f=u(()=>{const n=new Date().getMonth()+1,s=new Date().getFullYear();return c.invoices.filter(e=>e.month===n&&e.year===s)}),M=u(()=>c.invoices.filter(n=>n.status==="paid").length),$=u(()=>c.invoices.filter(n=>n.status!=="paid").length),p=n=>!n&&n!==0?"0 ₫":new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n),b=n=>n?new Date(n).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"}):"",T=n=>({upcoming:"Sắp tới",active:"Đang ở",past:"Đã ở",pending:"Chờ thanh toán",completed:"Đã kết thúc",cancelled:"Đã hủy"})[n]||n,V=n=>({upcoming:"bg-amber-100 text-amber-800 border border-amber-300",active:"bg-green-100 text-green-700",past:"bg-gray-100 text-gray-600",pending:"bg-yellow-100 text-yellow-700",completed:"bg-gray-100 text-gray-600",cancelled:"bg-red-100 text-red-700"})[n]||"bg-gray-100 text-gray-600",H=n=>({pending:"Chờ thanh toán",paid:"Đã thanh toán",failed:"Thanh toán thất bại",cancelled:"Đã hủy"})[n]||n,S=n=>({pending:"bg-yellow-100 text-yellow-700",paid:"bg-green-100 text-green-700",failed:"bg-red-100 text-red-700",cancelled:"bg-gray-100 text-gray-600"})[n]||"bg-gray-100 text-gray-600",j=n=>{L.visit(`/payment/${n}`,{preserveState:!1,preserveScroll:!1})};return D(()=>{const s=P().props.flash,e=new URLSearchParams(window.location.search),m=s?.contract_booking_id||e.get("contract");if(m){const B=`/contract/${m}`;if(window.open(B,"_blank"),e.has("contract")){e.delete("contract");const N=window.location.pathname+(e.toString()?"?"+e.toString():"");window.history.replaceState({},"",N)}}}),(n,s)=>(r(),o(y,null,[l(i(I),{title:"Lịch sử thuê phòng"}),l(A,null,{default:h(()=>[t("div",U,[t("div",z,[n.$page.props.flash?.success?(r(),o("div",R,[t("p",Y,a(n.$page.props.flash.success),1)])):d("",!0),n.$page.props.flash?.error?(r(),o("div",q,[t("p",E,a(n.$page.props.flash.error),1)])):d("",!0),n.$page.props.flash?.info?(r(),o("div",Q,[t("p",X,a(n.$page.props.flash.info),1)])):d("",!0),s[17]||(s[17]=t("div",{class:"mb-8"},[t("h1",{class:"text-4xl font-bold text-secondary mb-2"},"Lịch sử thuê phòng"),t("p",{class:"text-gray-600"},"Quản lý các phòng bạn đã thuê")],-1)),t("div",G,[t("div",J,[g.bookings.length===0?(r(),o("div",K,[l(i(Z),{class:"w-24 h-24 mx-auto text-gray-300 mb-4"}),s[1]||(s[1]=t("h3",{class:"text-2xl font-bold text-gray-400 mb-2"},"Chưa có lịch sử thuê",-1)),s[2]||(s[2]=t("p",{class:"text-gray-500 mb-6"},"Bạn chưa thuê phòng nào",-1)),l(i(_),{href:"/houses",class:"btn-primary inline-block"},{default:h(()=>[...s[0]||(s[0]=[v(" Tìm phòng ngay ",-1)])]),_:1})])):d("",!0),(r(!0),o(y,null,w(g.bookings,e=>(r(),o("div",{key:e.id,class:"card p-6"},[t("div",O,[t("div",W,[t("div",tt,[t("h3",st,a(e.room_name),1),e.booking_code?(r(),o("span",et,a(e.booking_code),1)):d("",!0)]),t("p",nt,a(e.house_name),1)]),t("span",{class:x(["badge",V(e.booking_status||e.status)])},a(T(e.booking_status||e.status)),3)]),t("div",at,[t("div",ot,[l(i(k),{class:"w-5 h-5"}),t("div",null,[s[3]||(s[3]=t("p",{class:"text-xs text-gray-500"},"Ngày bắt đầu",-1)),t("p",rt,a(b(e.start_date)),1)])]),t("div",lt,[l(i(k),{class:"w-5 h-5"}),t("div",null,[s[4]||(s[4]=t("p",{class:"text-xs text-gray-500"},"Ngày kết thúc",-1)),t("p",it,a(b(e.end_date)),1)])])]),t("div",dt,[t("span",{class:x(["inline-block px-3 py-1 text-xs rounded-full",S(e.payment_status)])},a(H(e.payment_status)),3)]),t("div",ct,[t("div",null,[s[5]||(s[5]=t("p",{class:"text-sm text-gray-600"},"Tổng tiền",-1)),t("p",pt,a(p(e.total_price)),1)]),t("div",gt,[l(i(_),{href:`/my-rentals/${e.id}`,class:"px-4 py-2 bg-secondary text-white rounded-lg hover:bg-secondary-700 transition-all"},{default:h(()=>[...s[6]||(s[6]=[v(" Chi tiết ",-1)])]),_:1},8,["href"]),e.payment_status==="pending"?(r(),o("button",{key:0,onClick:m=>j(e.id),class:"px-4 py-2 border-2 border-primary text-primary rounded-lg hover:bg-primary hover:text-white transition-all"}," Thanh toán ",8,ut)):d("",!0),e.payment_status==="paid"?(r(),o("a",{key:1,href:`/contract/${e.id}`,target:"_blank",class:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all"}," Xem hợp đồng ",8,mt)):d("",!0)])])]))),128))]),t("div",ht,[t("div",yt,[t("div",null,[s[16]||(s[16]=t("h2",{class:"text-xl font-bold text-secondary mb-6"},"Hóa đơn tháng này",-1)),f.value.length===0?(r(),o("div",xt,[l(i(F),{class:"w-16 h-16 mx-auto text-gray-300 mb-2"}),s[7]||(s[7]=t("p",{class:"text-gray-500 text-sm"},"Chưa có hóa đơn",-1))])):(r(),o("div",ft,[(r(!0),o(y,null,w(f.value,e=>(r(),o("div",{key:e.id,class:"p-4 bg-light rounded-lg"},[t("div",bt,[t("span",_t,"Hóa đơn "+a(e.month_year),1),t("span",{class:x(["badge text-xs",e.status==="paid"?"bg-primary-100 text-primary-700":"bg-secondary-100 text-secondary-700"])},a(e.status==="paid"?"Đã thanh toán":"Chưa thanh toán"),3)]),t("div",vt,[t("div",wt,[s[8]||(s[8]=t("span",{class:"text-gray-600"},"Tiền điện",-1)),t("span",kt,a(p(e.electricity)),1)]),t("div",Ct,[s[9]||(s[9]=t("span",{class:"text-gray-600"},"Tiền nước",-1)),t("span",Mt,a(p(e.water)),1)]),t("div",$t,[s[10]||(s[10]=t("span",{class:"text-gray-600"},"Internet",-1)),t("span",Tt,a(p(e.internet)),1)])]),t("div",Vt,[s[11]||(s[11]=t("span",{class:"font-semibold text-gray-700"},"Tổng cộng",-1)),t("span",Ht,a(p(e.total)),1)])]))),128))])),t("div",St,[s[15]||(s[15]=t("h3",{class:"font-semibold text-gray-800 mb-3"},"Thống kê",-1)),t("div",jt,[t("div",Bt,[s[12]||(s[12]=t("span",{class:"text-sm text-gray-700"},"Tổng phòng đang thuê",-1)),t("span",Nt,a(C.value.length),1)]),t("div",Dt,[s[13]||(s[13]=t("span",{class:"text-sm text-gray-700"},"Hóa đơn đã thanh toán",-1)),t("span",Pt,a(M.value),1)]),t("div",It,[s[14]||(s[14]=t("span",{class:"text-sm text-gray-700"},"Hóa đơn chưa thanh toán",-1)),t("span",Lt,a($.value),1)])])])])])])])])])]),_:1})],64))}};export{Gt as default};
